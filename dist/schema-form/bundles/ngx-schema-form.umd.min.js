!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("rxjs/operators"),require("z-schema"),require("@angular/core"),require("@angular/forms"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-schema-form",["exports","rxjs","rxjs/operators","z-schema","@angular/core","@angular/forms","@angular/common"],e):e(t["ngx-schema-form"]={},t.rxjs,t.rxjs.operators,t.ZSchema,t.ng.core,t.ng.forms,t.ng.common)}(this,function(t,y,m,r,a,i,e){"use strict";var n=function(){function t(){this.actions={}}return t.prototype.clear=function(){this.actions={}},t.prototype.register=function(t,e){this.actions[t]=e},t.prototype.get=function(t){return this.actions[t]},t}(),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function c(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function x(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return s}function l(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}var v=function(){function t(t,e,r,n,i){this.validatorRegistry=e,this.schema=r,this._value=null,this._errors=null,this._valueChanges=new y.BehaviorSubject(null),this._errorsChanges=new y.BehaviorSubject(null),this._visible=!0,this._visibilityChanges=new y.BehaviorSubject(!0),this.schemaValidator=t.createValidatorFn(this.schema),(this._parent=n)?this._root=n.root:this instanceof d&&(this._root=this),this._path=i}return Object.defineProperty(t.prototype,"valueChanges",{get:function(){return this._valueChanges},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorsChanges",{get:function(){return this._errorsChanges},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.schema.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root||this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return null===this._errors},enumerable:!0,configurable:!0}),t.prototype.updateValueAndValidity=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0),this._updateValue(),e&&this.valueChanges.next(this.value),this._runValidation(),this.parent&&!t&&this.parent.updateValueAndValidity(t,e)},t.prototype._runValidation=function(){var t=this.schemaValidator(this._value)||[],e=this.validatorRegistry.get(this.path);if(e){var r=e(this.value,this,this.findRoot());t=this.mergeErrors(t,r)}0===t.length&&(t=null),this._errors=t,this.setErrors(this._errors)},t.prototype.mergeErrors=function(t,e){return e&&(Array.isArray(e)?t=t.concat.apply(t,l(e)):t.push(e)),t},t.prototype.setErrors=function(t){this._errors=t,this._errorsChanges.next(t)},t.prototype.extendErrors=function(t){t=this.mergeErrors(this._errors||[],t),this.setErrors(t)},t.prototype.searchProperty=function(t){var e=this,r=null,n=null;if("/"===t[0])n=(r=this.findRoot()).getProperty(t.substr(1));else for(;null===n&&null!==e.parent;)e=r=e.parent,n=r.getProperty(t);return n},t.prototype.findRoot=function(){for(var t=this;null!==t.parent;)t=t.parent;return t},t.prototype.setVisible=function(t){this._visible=t,this._visibilityChanges.next(t),this.updateValueAndValidity(),this.parent&&this.parent.updateValueAndValidity(!1,!0)},t.prototype.__bindVisibility=function(){var t,e,f=this,r=this.schema.visibleIf,n=(r||{}).oneOf||(r||{}).allOf;if(n){var i=function(u){if("object"==typeof u&&0===Object.keys(u).length)d.setVisible(!1);else if(u!==undefined){var h=[],t=function(e){var t,r;if(u.hasOwnProperty(e)){var n=d.findProperties(d,e);if((n||[]).length)try{for(var i=x(n),o=i.next();!o.done;o=i.next()){var s=o.value;if(s){var a=void 0;if(d.schema.visibleIf.oneOf)a=s.valueChanges.pipe(m.map(function(t){return-1!==u[e].indexOf("$ANY$")?0<t.length:-1!==u[e].indexOf(t)}));else if(d.schema.visibleIf.allOf){a=s.valueChanges.pipe(m.map(function(t){var e,r,n,i;try{for(var o=x(f.schema.visibleIf.allOf),s=o.next();!s.done;s=o.next()){var a=s.value;try{for(var c=x(Object.keys(a)),l=c.next();!l.done;l=c.next()){var p=l.value,u=f.searchProperty(p)._value;if(!(-1!==a[p].indexOf("$ANY$")?0<u.length:-1!==a[p].indexOf(u)))return!1}}catch(h){n={error:h}}finally{try{l&&!l.done&&(i=c["return"])&&i.call(c)}finally{if(n)throw n.error}}}}catch(d){e={error:d}}finally{try{s&&!s.done&&(r=o["return"])&&r.call(o)}finally{if(e)throw e.error}}return!0}))}var c=s._visibilityChanges,l=y.combineLatest([a,c],function(t,e){return t&&e});h.push(l)}}}catch(p){t={error:p}}finally{try{o&&!o.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}else console.warn("Can't find property "+e+" for visibility check of "+d.path),d.registerMissingVisibilityBinding(e,d),d.setVisible(!1)}};for(var e in u)t(e);y.combineLatest(h,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return-1!==t.indexOf(!0)}).pipe(m.distinctUntilChanged()).subscribe(function(t){f.setVisible(t)})}},d=this;try{for(var o=x(n),s=o.next();!s.done;s=o.next()){i(s.value)}}catch(a){t={error:a}}finally{try{s&&!s.done&&(e=o["return"])&&e.call(o)}finally{if(t)throw t.error}}return!0}},t.prototype._bindVisibility=function(){var e=this;if(!this.__bindVisibility()){var u=this.schema.visibleIf;if("object"==typeof u&&0===Object.keys(u).length)this.setVisible(!1);else if(u!==undefined){var h=[],t=function(e){var t,r;if(u.hasOwnProperty(e)){var n=d.findProperties(d,e);if((n||[]).length)try{for(var i=x(n),o=i.next();!o.done;o=i.next()){var s=o.value;if(s){var a=s.valueChanges.pipe(m.map(function(t){return-1!==u[e].indexOf("$ANY$")?0<t.length:-1!==u[e].indexOf(t)})),c=s._visibilityChanges,l=y.combineLatest([a,c],function(t,e){return t&&e});h.push(l)}}}catch(p){t={error:p}}finally{try{o&&!o.done&&(r=i["return"])&&r.call(i)}finally{if(t)throw t.error}}else console.warn("Can't find property "+e+" for visibility check of "+d.path),d.registerMissingVisibilityBinding(e,d),d.setVisible(!1)}},d=this;for(var r in u)t(r);y.combineLatest(h,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return-1!==t.indexOf(!0)}).pipe(m.distinctUntilChanged()).subscribe(function(t){e.setVisible(t)})}}},t.prototype.registerMissingVisibilityBinding=function(t,e){e._propertyBindingRegistry.getPropertyBindingsVisibility().add(t,e.path)},t.prototype.findProperties=function(t,e){var r,n,i=[],o=this.findPropertyPaths(t,e);try{for(var s=x(o),a=s.next();!a.done;a=s.next()){var c=a.value,l=t.searchProperty(c);l&&i.push(l)}}catch(p){r={error:p}}finally{try{a&&!a.done&&(n=s["return"])&&n.call(s)}finally{if(r)throw r.error}}return i},t.prototype.findPropertyPaths=function(t,e,r){var n=e.indexOf("*");if(-1===n)return[e];var i=-1<n?e.substring(0,n-1):e,o=-1<n?e.substring(n+1):e,s=t.searchProperty(i),a=[];if(s instanceof d)for(var c=s.properties,l=0;l<c.length;l++){var p=(r||"")+i+(i.endsWith("/")?"":"/")+l+o,u=(r||"")+i+l;-1===p.indexOf("*")&&a.push(p);var h=this.findPropertyPaths(c[l],o,u);a=a.concat(h)}return a},t}(),d=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t._properties=null,t._propertyProxyHandler={set:function(p,u,t,e){var r=function(t){var e,r,n=t;Array.isArray(p)&&t instanceof v&&n&&(n._canonicalPath=function(t,e){var r;if(t&&-1!==(r=t.lastIndexOf("*")))return t.substring(0,r)+e.toString()+t.substring(r+1)}(n._canonicalPath,u));var i=n,o=Array.isArray(i.properties)?i.properties:Object.values(i.properties||{});if((n.path||"").endsWith("/*"))try{for(var s=x(o),a=s.next();!a.done;a=s.next()){var c=a.value;c._canonicalPath=n._canonicalPath+c._canonicalPath.substring(n.path.length)}}catch(l){e={error:l}}finally{try{a&&!a.done&&(r=s["return"])&&r.call(s)}finally{if(e)throw e.error}}return{property:n,children:o}}(t),m=r.property,g=r.children,n=p[u]=t;return function(){var t,e,r,n,i=[m].concat(g),o=function(t){var e,r,n=t._propertyBindingRegistry.getPropertyBindingsVisibility(),i=[];t._canonicalPath&&(i=i.concat(i.concat(n.findByDependencyPath(t._canonicalPath)||[])),t._canonicalPath.startsWith("/")&&(i=i.concat(i.concat(n.findByDependencyPath(t._canonicalPath.substring(1))||[])))),i=i.concat(n.findByDependencyPath(t.path)||[]),t.path.startsWith("/")&&(i=i.concat(i.concat(n.findByDependencyPath(t.path.substring(1))||[])));var o={};try{for(var s=x(i),a=s.next();!a.done;a=s.next()){var c=a.value;o[c]=c}}catch(l){e={error:l}}finally{try{a&&!a.done&&(r=s["return"])&&r.call(s)}finally{if(e)throw e.error}}return Object.keys(o)};try{for(var s=x(i),a=s.next();!a.done;a=s.next()){var c=a.value;if(c instanceof v)try{var l=o(c);try{for(var p=x(l),u=p.next();!u.done;u=p.next()){var h=u.value;c.searchProperty(h)._bindVisibility()}}catch(d){r={error:d}}finally{try{u&&!u.done&&(n=p["return"])&&n.call(p)}finally{if(r)throw r.error}}}catch(f){console.error("Rebinding visibility error at path:",c.path,"property:",c,f)}}}catch(y){t={error:y}}finally{try{a&&!a.done&&(e=s["return"])&&e.call(s)}finally{if(t)throw t.error}}}(),n},get:function(t,e,r){return t[e]},deleteProperty:function(t,e){return delete t[e]}},t}return c(o,e),Object.defineProperty(o.prototype,"properties",{get:function(){return this._properties},set:function(t){this._properties=new Proxy(t,this._propertyProxyHandler)},enumerable:!0,configurable:!0}),o.prototype.getProperty=function(t){var e=t.indexOf("/"),r=-1!==e?t.substr(0,e):t,n=this.properties[r];if(null!==n&&-1!==e&&n instanceof o){var i=t.substr(e+1);n=n.getProperty(i)}return n},o.prototype.forEachChild=function(t){for(var e in this.properties){if(this.properties.hasOwnProperty(e))t(this.properties[e],e)}},o.prototype.forEachChildRecursive=function(e){this.forEachChild(function(t){e(t),t instanceof o&&t.forEachChildRecursive(e)})},o.prototype._bindVisibility=function(){e.prototype._bindVisibility.call(this),this._bindVisibilityRecursive()},o.prototype._bindVisibilityRecursive=function(){this.forEachChildRecursive(function(t){t._bindVisibility()})},o.prototype.isRoot=function(){return this===this.root},o}(v),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.setValue=function(t,e){void 0===e&&(e=!1),this._value=t,this.updateValueAndValidity(e,!0)},e.prototype.reset=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!0),this.resetValue(t),this.updateValueAndValidity(e,!0)},e.prototype.resetValue=function(t){null===t&&(t=this.schema["default"]!==undefined?this.schema["default"]:this.fallbackValue()),this._value=t},e.prototype._hasValue=function(){return this.fallbackValue()!==this.value},e.prototype._updateValue=function(){},e}(v),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.fallbackValue=function(){return null},e.prototype.setValue=function(t,e){void 0===e&&(e=!1),"string"==typeof t&&(t=t.length?-1<t.indexOf(".")?parseFloat(t):parseInt(t,10):null),this._value=t,this.updateValueAndValidity(e,!0)},e}(p),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.fallbackValue=function(){return""},e}(p),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.fallbackValue=function(){return null},e}(p),g=function(a){function t(t,e,r,n,i,o){var s=a.call(this,e,r,n,i,o)||this;return s.formPropertyFactory=t,s.propertiesId=[],s.createProperties(),s}return c(t,a),t.prototype.setValue=function(t,e){for(var r in t)t.hasOwnProperty(r)&&this.properties[r].setValue(t[r],!0);this.updateValueAndValidity(e,!0)},t.prototype.reset=function(t,e){void 0===e&&(e=!0),t=t||this.schema["default"]||{},this.resetProperties(t),this.updateValueAndValidity(e,!0)},t.prototype.resetProperties=function(t){for(var e in this.schema.properties)this.schema.properties.hasOwnProperty(e)&&this.properties[e].reset(t[e],!0)},t.prototype.createProperties=function(){for(var t in this.properties={},this.propertiesId=[],this.schema.properties)if(this.schema.properties.hasOwnProperty(t)){var e=this.schema.properties[t];this.properties[t]=this.formPropertyFactory.createProperty(e,this,t),this.propertiesId.push(t)}},t.prototype._hasValue=function(){return!!Object.keys(this.value).length},t.prototype._updateValue=function(){this.reduceValue()},t.prototype._runValidation=function(){var r=this;a.prototype._runValidation.call(this),this._errors&&this._errors.forEach(function(t){var e=r.searchProperty(t.path.slice(1));e&&e.extendErrors(t)})},t.prototype.reduceValue=function(){var r={};this.forEachChild(function(t,e){t.visible&&t._hasValue()&&(r[e]=t.value)}),this._value=r},t}(d),b=function(a){function t(t,e,r,n,i,o){var s=a.call(this,e,r,n,i,o)||this;return s.formPropertyFactory=t,s}return c(t,a),t.prototype.addItem=function(t){void 0===t&&(t=null);var e=this.addProperty();return e.reset(t,!1),e},t.prototype.addProperty=function(){var t=this.formPropertyFactory.createProperty(this.schema.items,this);return this.properties.push(t),t},t.prototype.removeItem=function(e){this.properties=this.properties.filter(function(t){return t!==e}),this.updateValueAndValidity(!1,!0)},t.prototype.setValue=function(t,e){this.createProperties(),this.resetProperties(t),this.updateValueAndValidity(e,!0)},t.prototype._hasValue=function(){return!0},t.prototype._updateValue=function(){this.reduceValue()},t.prototype.reduceValue=function(){var r=[];this.forEachChild(function(t,e){t.visible&&t._hasValue()&&r.push(t.value)}),this._value=r},t.prototype.reset=function(t,e){void 0===e&&(e=!0),t=t||this.schema["default"]||[],this.properties=[],this.resetProperties(t),this.updateValueAndValidity(e,!0)},t.prototype.createProperties=function(){this.properties=[]},t.prototype.resetProperties=function(t){for(var e in t){if(t.hasOwnProperty(e))this.addProperty().reset(t[e],!0)}},t}(d),P=function(){function t(t,e,r){this.schemaValidatorFactory=t,this.validatorRegistry=e,this.propertyBindingRegistry=r}return t.prototype.createProperty=function(t,e,r){void 0===e&&(e=null);var n=null,i="",o="";if(e){if(i+=e.path,null!==e.parent&&(i+="/",o+="/"),"object"===e.type)i+=r,o+=r;else{if("array"!==e.type)throw"Instanciation of a FormProperty with an unknown parent type: "+e.type;i+="*",o+="*"}o=(e._canonicalPath||e.path)+o}else o=i="/";if(t.$ref){var s=this.schemaValidatorFactory.getSchema(e.root.schema,t.$ref);n=this.createProperty(s,e,i)}else switch(t.type){case"integer":case"number":n=new u(this.schemaValidatorFactory,this.validatorRegistry,t,e,i);break;case"string":n=new h(this.schemaValidatorFactory,this.validatorRegistry,t,e,i);break;case"boolean":n=new f(this.schemaValidatorFactory,this.validatorRegistry,t,e,i);break;case"object":n=new g(this,this.schemaValidatorFactory,this.validatorRegistry,t,e,i);break;case"array":n=new b(this,this.schemaValidatorFactory,this.validatorRegistry,t,e,i);break;default:throw new TypeError("Undefined type "+t.type)}return n._propertyBindingRegistry=this.propertyBindingRegistry,n._canonicalPath=o,n instanceof d&&this.initializeRoot(n),n},t.prototype.initializeRoot=function(t){t.reset(null,!0),t._bindVisibility()},t}();function w(t,e){return"Parsing error on "+e+": "+t}function O(t,e){var r=w(t,e);throw new Error(r)}function V(t,e){var r=w(t,e);throw new Error(r)}var C=function(){function i(){}return i.preprocess=function(t,e){void 0===e&&(e="/"),i.normalizeExtensions(t=t||{}),"object"===t.type?(i.checkProperties(t,e),i.checkAndCreateFieldsets(t,e)):"array"===t.type&&i.checkItems(t,e),i.normalizeWidget(t),i.recursiveCheck(t,e)},i.checkProperties=function(t,e){(function r(t){return null===t||t===undefined})(t.properties)&&(t.properties={},V("Provided json schema does not contain a 'properties' entry. Output schema will be empty",e))},i.checkAndCreateFieldsets=function(t,e){t.fieldsets===undefined&&(t.order!==undefined?i.replaceOrderByFieldsets(t):i.createFieldsets(t)),i.checkFieldsUsage(t,e)},i.checkFieldsUsage=function(t,e){var r,n,i,o,s,a,c=Object.keys(t.properties),l={};try{for(var p=x(t.fieldsets),u=p.next();!u.done;u=p.next()){var h=u.value;try{for(var d=x(h.fields),f=d.next();!f.done;f=d.next()){l[g=f.value]===undefined&&(l[g]=[]),l[g].push(h.id)}}catch(P){i={error:P}}finally{try{f&&!f.done&&(o=d["return"])&&o.call(d)}finally{if(i)throw i.error}}}}catch(w){r={error:w}}finally{try{u&&!u.done&&(n=p["return"])&&n.call(p)}finally{if(r)throw r.error}}try{for(var y=x(c),m=y.next();!m.done;m=y.next()){var g=m.value,v=t.required&&-1<t.required.indexOf(g);v&&t.properties[g]&&(t.properties[g].isRequired=!0),l.hasOwnProperty(g)?(1<l[g].length&&O(g+" is referenced by more than one fieldset: "+l[g],e),delete l[g]):v?O(g+" is a required field but it is not referenced as part of a 'order' or a 'fieldset' property",e):(delete t[g],V("Removing unreferenced field "+g,e))}}catch(C){s={error:C}}finally{try{m&&!m.done&&(a=y["return"])&&a.call(y)}finally{if(s)throw s.error}}for(var b in l)l.hasOwnProperty(b)&&V("Referencing non-existent field "+b+" in one or more fieldsets",e)},i.createFieldsets=function(t){t.order=Object.keys(t.properties),i.replaceOrderByFieldsets(t)},i.replaceOrderByFieldsets=function(t){t.fieldsets=[{id:"fieldset-default",title:t.title||"",description:t.description||"",name:t.name||"",fields:t.order}],delete t.order},i.normalizeWidget=function(t){var e=t.widget;e===undefined?e={id:t.type}:"string"==typeof e&&(e={id:e}),t.widget=e},i.checkItems=function(t,e){t.items===undefined&&O("No 'items' property in array",e)},i.recursiveCheck=function(t,e){if("object"===t.type){for(var r in t.properties)if(t.properties.hasOwnProperty(r)){var n=t.properties[r];i.preprocess(n,e+r+"/")}if(t.hasOwnProperty("definitions"))for(var r in t.definitions)if(t.definitions.hasOwnProperty(r)){n=t.definitions[r];i.removeRecursiveRefProperties(n,"#/definitions/"+r),i.preprocess(n,e+r+"/")}}else"array"===t.type&&i.preprocess(t.items,e+"*/")},i.removeRecursiveRefProperties=function(t,e){if("object"===t.type)for(var r in t.properties)t.properties.hasOwnProperty(r)&&(t.properties[r].$ref&&t.properties[r].$ref===e?delete t.properties[r]:"object"===t.properties[r].type&&i.removeRecursiveRefProperties(t.properties[r],e))},i.normalizeExtensions=function(o){for(var s=[{name:"fieldsets",regex:/^x-?field-?sets$/i},{name:"widget",regex:/^x-?widget$/i},{name:"visibleIf",regex:/^x-?visible-?if$/i}],a=Object.keys(o),t=function(t){var e=a[t],r=s.find(function(t){return!!e.match(t.regex)});if(r){var n=o[e],i=JSON.parse(JSON.stringify(n));o[r.name]=i}},e=0;e<a.length;++e)t(e)},i}(),I=function(){function t(){this.validators=[]}return t.prototype.register=function(t,e){this.validators[t]=e},t.prototype.get=function(t){return this.validators[t]},t.prototype.clear=function(){this.validators=[]},t}(),_=function(){function t(){this.bindings=[]}return t.prototype.clear=function(){this.bindings=[]},t.prototype.register=function(t,e){this.bindings[t]=[].concat(e)},t.prototype.get=function(t){return this.bindings[t]},t}(),R=function(){function t(){}return t.prototype.reset=function(){},t}(),E=function(e){function t(){var t=e.call(this)||this;return t.createSchemaValidator(),t}return c(t,e),t.prototype.createSchemaValidator=function(){this.zschema=new r({breakOnFirstError:!1})},t.prototype.reset=function(){this.createSchemaValidator()},t.prototype.createValidatorFn=function(r){var n=this;return function(t){"number"!==r.type&&"integer"!==r.type||(t=+t),n.zschema.validate(t,r);var e=n.zschema.getLastErrors();return n.denormalizeRequiredPropertyPaths(e),e||null}},t.prototype.getSchema=function(t,e){if(this.zschema.compileSchema(t))return this.getDefinition(t,e);throw this.zschema.getLastError()},t.prototype.denormalizeRequiredPropertyPaths=function(t){t&&t.length&&(t=t.map(function(t){return"#/"===t.path&&"OBJECT_MISSING_REQUIRED_PROPERTY"===t.code&&(t.path=""+t.path+t.params[0]),t}))},t.prototype.getDefinition=function(t,e){var r=t;return e.split("/").slice(1).forEach(function(t){t&&(r=r[t])}),r},t}(R),F=function(){function t(){this.widgets={}}return t.prototype.setDefaultWidget=function(t){this.defaultWidget=t},t.prototype.getDefaultWidget=function(){return this.defaultWidget},t.prototype.hasWidget=function(t){return this.widgets.hasOwnProperty(t)},t.prototype.register=function(t,e){this.widgets[t]=e},t.prototype.getWidgetType=function(t){return this.hasWidget(t)?this.widgets[t]:this.defaultWidget},t}(),k=function(){function t(t,e){this.registry=t,this.resolver=e}return t.prototype.createWidget=function(t,e){var r=this.registry.getWidgetType(e),n=this.resolver.resolveComponentFactory(r);return t.createComponent(n)},t.decorators=[{type:a.Injectable}],t.ctorParameters=function(){return[{type:F},{type:a.ComponentFactoryResolver}]},t}(),j=function(){function t(){this.onDestroy=new y.Subject}return t.prototype.destroy=function(){this.onDestroy.next(!0)},t.decorators=[{type:a.Injectable}],t.ctorParameters=function(){return[]},t}(),A=function(){function t(){this.bindings={}}return t.prototype.getPropertyBindings=function(t){return this.bindings[t]=this.bindings[t]||new B,this.bindings[t]},t.prototype.getPropertyBindingsVisibility=function(){return this.getPropertyBindings(S.visibility)},t}(),S={visibility:0};S[S.visibility]="visibility";var B=function(){function t(){this.sourcesIndex=new W,this.dependenciesIndex=new W}return t.prototype.add=function(t,e){this.sourcesIndex.store(e,t),this.dependenciesIndex.store(t,e)},t.prototype.findByDependencyPath=function(t){var e,r,n=this.dependenciesIndex.find(t);n.results=n.results||[];var i=[];try{for(var o=x(n.results),s=o.next();!s.done;s=o.next()){var a=s.value;i=i.concat(Object.keys(a.value))}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o["return"])&&r.call(o)}finally{if(e)throw e.error}}return n.found?i:[]},t.prototype.getBySourcePropertyPath=function(t){var e,r,n=this.sourcesIndex.find(t);n.results=n.results||[];var i=[];try{for(var o=x(n.results),s=o.next();!s.done;s=o.next()){var a=s.value;i=i.concat(Object.keys(a.value))}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o["return"])&&r.call(o)}finally{if(e)throw e.error}}return n.found?i:[]},t.prototype.createPathIndex=function(t){return t.split("/")},t}(),W=function(){function P(){this.index={},this.findOnlyWithValue=!0}return P.prototype._createPathIndex=function(t){return t.replace(new RegExp("//","g"),"/").replace(new RegExp("^/","g"),"").split("/").filter(function(t){return t})},P.prototype.store=function(t,e){this._storeIndex(this._createPathIndex(t),e)},P.prototype._storeIndex=function(t,e){var r,n,i=this.index;try{for(var o=x(t),s=o.next();!s.done;s=o.next()){var a=s.value;i[a]=i[a]||{},i=i[a]}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=o["return"])&&n.call(o)}finally{if(r)throw r.error}}i&&e&&(i[P.MARKER]=i[P.MARKER]||{},i[P.MARKER][e]=e)},P.prototype.find=function(t){return this._findInIndex(this._createPathIndex(t))},P.prototype._findInIndex=function(t){var e={target:t,found:!1,results:[]};return this.__findIndex(e,t,this.index,[]),e},P.prototype.__findIndex=function(t,e,r,n){var i,o,s=n||[],a=e[0],c="*"===a?Object.keys(r):[],l=(Array.isArray(a)?a:[a]).concat(c),p=l.filter(function(t,e){return"*"!==t&&l.indexOf(t)===e});r["*"]&&p.push("*");var u=[];try{for(var h=x(p),d=h.next();!d.done;d=h.next()){var f=d.value,y=e.slice(1),m=r[f],g=s.concat(f);if(1===e.length&&(!this.findOnlyWithValue||m&&m[P.MARKER])&&(t.results=t.results||[],t.results.push({path:g,value:m[P.MARKER]}),u.push(g),t.found=0<t.results.length),!y||!y.length||!m)break;var v=this.__findIndex(t,y,m,g);u=u.concat(v)}}catch(b){i={error:b}}finally{try{d&&!d.done&&(o=h["return"])&&o.call(h)}finally{if(i)throw i.error}}return u},P.MARKER="$____value",P}();function D(t,e,r){return new P(t,e,r)}var z=function(){function t(t,e,r,n,i,o){this.formPropertyFactory=t,this.actionRegistry=e,this.validatorRegistry=r,this.bindingRegistry=n,this.cdr=i,this.terminator=o,this.schema=null,this.actions={},this.validators={},this.bindings={},this.onChange=new a.EventEmitter,this.modelChange=new a.EventEmitter,this.isValid=new a.EventEmitter,this.onErrorChange=new a.EventEmitter,this.onErrorsChange=new a.EventEmitter,this.rootProperty=null}return t.prototype.writeValue=function(t){this.rootProperty&&this.rootProperty.reset(t,!1)},t.prototype.registerOnChange=function(t){this.onChangeCallback=t,this.rootProperty&&this.rootProperty.valueChanges.subscribe(this.onValueChanges.bind(this))},t.prototype.registerOnTouched=function(t){},t.prototype.ngOnChanges=function(t){var e=this;t.validators&&this.setValidators(),t.actions&&this.setActions(),t.bindings&&this.setBindings(),this.schema&&!this.schema.type&&(this.schema.type="object"),this.schema&&t.schema&&(t.schema.firstChange||this.terminator.destroy(),C.preprocess(this.schema),this.rootProperty=this.formPropertyFactory.createProperty(this.schema),this.model,this.rootProperty.valueChanges.subscribe(this.onValueChanges.bind(this)),this.rootProperty.errorsChanges.subscribe(function(t){e.onErrorChange.emit({value:t}),e.isValid.emit(!(t&&t.length))})),this.schema&&(t.model||t.schema)&&(this.rootProperty.reset(this.model,!1),this.cdr.detectChanges())},t.prototype.setValidators=function(){if(this.validatorRegistry.clear(),this.validators)for(var t in this.validators)this.validators.hasOwnProperty(t)&&this.validatorRegistry.register(t,this.validators[t])},t.prototype.setActions=function(){if(this.actionRegistry.clear(),this.actions)for(var t in this.actions)this.actions.hasOwnProperty(t)&&this.actionRegistry.register(t,this.actions[t])},t.prototype.setBindings=function(){if(this.bindingRegistry.clear(),this.bindings)for(var t in this.bindings)this.bindings.hasOwnProperty(t)&&this.bindingRegistry.register(t,this.bindings[t])},t.prototype.reset=function(){this.rootProperty.reset(null,!0)},t.prototype.setModel=function(t){this.model?Object.assign(this.model,t):this.model=t},t.prototype.onValueChanges=function(t){this.onChangeCallback&&(this.setModel(t),this.onChangeCallback(t)),0<this.modelChange.observers.length&&(this.onChangeCallback||this.setModel(t)),this.onChange.emit({value:t})},t.decorators=[{type:a.Component,args:[{selector:"sf-form",template:'\n    <form>\n      <sf-form-element\n        *ngIf="rootProperty" [formProperty]="rootProperty"></sf-form-element>\n    </form>',providers:[n,I,A,_,C,k,{provide:P,useFactory:D,deps:[R,I,A]},j,{provide:i.NG_VALUE_ACCESSOR,useExisting:t,multi:!0}]}]}],t.ctorParameters=function(){return[{type:P},{type:n},{type:I},{type:_},{type:a.ChangeDetectorRef},{type:j}]},t.propDecorators={schema:[{type:a.Input}],model:[{type:a.Input}],actions:[{type:a.Input}],validators:[{type:a.Input}],bindings:[{type:a.Input}],onChange:[{type:a.Output}],modelChange:[{type:a.Output}],isValid:[{type:a.Output}],onErrorChange:[{type:a.Output}],onErrorsChange:[{type:a.Output}]},t}(),q=function(){function r(t,e,r,n){this.actionRegistry=t,this.bindingRegistry=e,this.renderer=r,this.elementRef=n,this.control=new i.FormControl("",function(){return null}),this.widget=null,this.buttons=[],this.unlisten=[]}return r.prototype.ngOnInit=function(){this.parseButtons(),this.setupBindings()},r.prototype.setupBindings=function(){var r=this,t=this.bindingRegistry.get(this.formProperty.path);(t||[]).length&&t.forEach(function(t){for(var e in t)r.createBinding(e,t[e])})},r.prototype.createBinding=function(e,r){var n=this;this.unlisten.push(this.renderer.listen(this.elementRef.nativeElement,e,function(t){r instanceof Function?r(t,n.formProperty):console.warn("Calling non function handler for eventId "+e+" for path "+n.formProperty.path)}))},r.prototype.parseButtons=function(){var t,e;if(this.formProperty.schema.buttons!==undefined){this.buttons=this.formProperty.schema.buttons;try{for(var r=x(this.buttons),n=r.next();!n.done;n=r.next()){var i=n.value;this.createButtonCallback(i)}}catch(o){t={error:o}}finally{try{n&&!n.done&&(e=r["return"])&&e.call(r)}finally{if(t)throw t.error}}}},r.prototype.createButtonCallback=function(r){var n=this;r.action=function(t){var e;r.id&&(e=n.actionRegistry.get(r.id))&&e&&e(n.formProperty,r.parameters),t.preventDefault()}},r.prototype.onWidgetInstanciated=function(t){this.widget=t;var e="field"+r.counter++;this.widget.formProperty=this.formProperty,this.widget.schema=this.formProperty.schema,this.widget.name=e,this.widget.id=e,this.widget.control=this.control},r.prototype.ngOnDestroy=function(){this.unlisten&&this.unlisten.forEach(function(t){t()})},r.counter=0,r.decorators=[{type:a.Component,args:[{selector:"sf-form-element",template:'\n    <div *ngIf="formProperty.visible"\n         [class.has-error]="!control.valid"\n         [class.has-success]="control.valid">\n      <sf-widget-chooser\n        (widgetInstanciated)="onWidgetInstanciated($event)"\n        [widgetInfo]="formProperty.schema.widget">\n      </sf-widget-chooser>\n      <sf-form-element-action *ngFor="let button of buttons" [button]="button" [formProperty]="formProperty"></sf-form-element-action>\n    </div>'}]}],r.ctorParameters=function(){return[{type:n},{type:_},{type:a.Renderer2},{type:a.ElementRef}]},r.propDecorators={formProperty:[{type:a.Input}]},r}(),M=function(){function t(t,e){void 0===t&&(t=null),this.widgetFactory=t,this.terminator=e}return t.prototype.ngOnInit=function(){var e=this;this.subs=this.terminator.onDestroy.subscribe(function(t){t&&e.ref.destroy()})},t.prototype.ngOnChanges=function(){this.ref=this.widgetFactory.createWidget(this.container,this.button.widget||"button"),this.ref.instance.button=this.button,this.ref.instance.formProperty=this.formProperty},t.prototype.ngOnDestroy=function(){this.subs.unsubscribe()},t.decorators=[{type:a.Component,args:[{selector:"sf-form-element-action",template:"<ng-template #target></ng-template>"}]}],t.ctorParameters=function(){return[{type:k},{type:j}]},t.propDecorators={button:[{type:a.Input}],formProperty:[{type:a.Input}],container:[{type:a.ViewChild,args:["target",{read:a.ViewContainerRef}]}]},t}(),L=function(){function t(t,e,r){void 0===t&&(t=null),this.widgetFactory=t,this.cdr=e,this.terminator=r,this.widgetInstanciated=new a.EventEmitter}return t.prototype.ngOnInit=function(){var e=this;this.subs=this.terminator.onDestroy.subscribe(function(t){t&&e.ref.destroy()})},t.prototype.ngOnChanges=function(){this.ref=this.widgetFactory.createWidget(this.container,this.widgetInfo.id),this.widgetInstanciated.emit(this.ref.instance),this.widgetInstance=this.ref.instance,this.cdr.detectChanges()},t.prototype.ngOnDestroy=function(){this.subs.unsubscribe()},t.decorators=[{type:a.Component,args:[{selector:"sf-widget-chooser",template:"<div #target></div>"}]}],t.ctorParameters=function(){return[{type:k},{type:a.ChangeDetectorRef},{type:j}]},t.propDecorators={widgetInfo:[{type:a.Input}],widgetInstanciated:[{type:a.Output}],container:[{type:a.ViewChild,args:["target",{read:a.ViewContainerRef}]}]},t}(),T=function vt(){this.id="",this.name="",this.schema={}},$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.ngAfterViewInit=function(){var e=this,n=this.control;this.formProperty.valueChanges.subscribe(function(t){n.value!==t&&n.setValue(t,{emitEvent:!1})}),this.formProperty.errorsChanges.subscribe(function(t){n.setErrors(t,{emitEvent:!0});var r=(t||[]).filter(function(t){return t.path&&t.path.slice(1)===e.formProperty.path}).map(function(t){return t.message});e.errorMessages=r.filter(function(t,e){return r.indexOf(t)===e})}),n.valueChanges.subscribe(function(t){e.formProperty.setValue(t,!1)})},e}(T),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.ngAfterViewInit=function(){var e=this.control;this.formProperty.errorsChanges.subscribe(function(t){e.setErrors(t,{emitEvent:!0})})},e}(T),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.ngAfterViewInit=function(){var e=this.control;this.formProperty.errorsChanges.subscribe(function(t){e.setErrors(t,{emitEvent:!0})})},e}(T),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.addItem=function(){this.formProperty.addItem()},e.prototype.removeItem=function(t){this.formProperty.removeItem(t)},e.prototype.trackByIndex=function(t,e){return t},e.decorators=[{type:a.Component,args:[{selector:"sf-array-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n\t<span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n\t<div *ngFor="let itemProperty of formProperty.properties">\n\t\t<sf-form-element [formProperty]="itemProperty"></sf-form-element>\n\t\t<button (click)="removeItem(itemProperty)" class="btn btn-default array-remove-button">\n\t\t\t<span class="glyphicon glyphicon-minus" aria-hidden="true"></span> Remove\n\t\t</button>\n\t</div>\n\t<button (click)="addItem()" class="btn btn-default array-add-button">\n\t\t<span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add\n\t</button>\n</div>'}]}],e}(H),K=function(){function t(){}return t.decorators=[{type:a.Component,args:[{selector:"sf-button-widget",template:'<button (click)="button.action($event)">{{button.label}}</button>'}]}],t}(),Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.decorators=[{type:a.Component,args:[{selector:"sf-form-object",template:'<fieldset *ngFor="let fieldset of formProperty.schema.fieldsets">\n\t<legend *ngIf="fieldset.title">{{fieldset.title}}</legend>\n\t<div *ngIf="fieldset.description">{{fieldset.description}}</div>\n\t<div *ngFor="let fieldId of fieldset.fields">\n\t\t<sf-form-element [formProperty]="formProperty.getProperty(fieldId)"></sf-form-element>\n\t</div>\n</fieldset>'}]}],e}(N),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checked={},t}return c(t,e),t.prototype.ngAfterViewInit=function(){var e=this,r=this.control;this.formProperty.valueChanges.subscribe(function(t){r.value!==t&&(r.setValue(t,{emitEvent:!1}),t&&Array.isArray(t)&&t.map(function(t){return e.checked[t]=!0}))}),this.formProperty.errorsChanges.subscribe(function(t){r.setErrors(t,{emitEvent:!0})}),r.valueChanges.subscribe(function(t){e.formProperty.setValue(t,!1)})},t.prototype.onCheck=function(t){t.checked?this.checked[t.value]=!0:delete this.checked[t.value],this.formProperty.setValue(Object.keys(this.checked),!1)},t.decorators=[{type:a.Component,args:[{selector:"sf-checkbox-widget",template:'<div class="widget form-group">\n    <label [attr.for]="id" class="horizontal control-label">\n        {{ schema.title }}\n    </label>\n\t<div *ngIf="schema.type!=\'array\'" class="checkbox">\n\t\t<label class="horizontal control-label">\n\t\t\t<input [formControl]="control" [attr.name]="name" [indeterminate]="control.value !== false && control.value !== true ? true :null" type="checkbox" [disabled]="schema.readOnly">\n\t\t\t<input *ngIf="schema.readOnly" [attr.name]="name" type="hidden" [formControl]="control">\n\t\t\t{{schema.description}}\n\t\t</label>\n\t</div>\n\t<ng-container *ngIf="schema.type===\'array\'">\n\t\t<div *ngFor="let option of schema.items.oneOf" class="checkbox">\n\t\t\t<label class="horizontal control-label">\n\t\t\t\t<input [attr.name]="name"\n\t\t\t\t\tvalue="{{option.enum[0]}}" type="checkbox" \n\t\t\t\t\t[attr.disabled]="schema.readOnly"\n\t\t\t\t\t(change)="onCheck($event.target)"\n\t\t\t\t\t[attr.checked]="checked[option.enum[0]] ? true : null">\n\t\t\t\t{{option.description}}\n\t\t\t</label>\n\t\t</div>\n\t</ng-container>\n</div>'}]}],t}($),G=function(e){function t(){var t=e.call(this)||this;return t.reader=new FileReader,t.filedata={},t}return c(t,e),t.prototype.ngAfterViewInit=function(){var t=this,e=this.control;this.formProperty.errorsChanges.subscribe(function(t){e.setErrors(t,{emitEvent:!0})}),this.reader.onloadend=function(){t.filedata.data=window.btoa(t.reader.result),t.formProperty.setValue(t.filedata,!1)}},t.prototype.onFileChange=function(t){var e=t.target.files[0];this.filedata.filename=e.name,this.filedata.size=e.size,this.filedata["content-type"]=e.type,this.filedata.encoding="base64",this.reader.readAsBinaryString(e)},t.decorators=[{type:a.Component,args:[{selector:"sf-file-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n    <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n  <input [name]="name" class="text-widget file-widget" [attr.id]="id"\n    [formControl]="control" type="file" [attr.disabled]="schema.readOnly?true:null"\n    (change)="onFileChange($event)">\n\t<input *ngIf="schema.readOnly" [attr.name]="name" type="hidden" [formControl]="control">\n</div>'}]}],t.ctorParameters=function(){return[]},t}($),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.decorators=[{type:a.Component,args:[{selector:"sf-integer-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n  <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n\t<input [attr.readonly]="schema.readOnly?true:null" [name]="name"\n\tclass="text-widget integer-widget form-control" [formControl]="control"\n\t[attr.type]="\'number\'" [attr.min]="schema.minimum" [attr.max]="schema.maximum"\n\t[attr.placeholder]="schema.placeholder"\n\t[attr.maxLength]="schema.maxLength || null"\n  [attr.minLength]="schema.minLength || null">\n</div>'}]}],e}($),Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.decorators=[{type:a.Component,args:[{selector:"sf-textarea-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n    <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n\t<textarea [readonly]="schema.readOnly" [name]="name"\n\t\tclass="text-widget textarea-widget form-control"\n\t\t[attr.placeholder]="schema.placeholder"\n\t\t[attr.maxLength]="schema.maxLength || null"\n    [attr.minLength]="schema.minLength || null"\n\t\t[formControl]="control"></textarea>\n</div>'}]}],e}($),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.decorators=[{type:a.Component,args:[{selector:"sf-radio-widget",template:'<div class="widget form-group">\n\t<label>{{schema.title}}</label>\n    <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n\t<div *ngFor="let option of schema.oneOf" class="radio">\n\t\t<label class="horizontal control-label">\n\t\t\t<input [formControl]="control" [attr.name]="name" value="{{option.enum[0]}}" type="radio"  [disabled]="schema.readOnly">\n\t\t\t{{option.description}}\n\t\t</label>\n\t</div>\n\t<input *ngIf="schema.readOnly" [attr.name]="name" type="hidden" [formControl]="control">\n</div>'}]}],e}($),tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.decorators=[{type:a.Component,args:[{selector:"sf-range-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n    <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\t\n\t<input [name]="name" class="text-widget range-widget" [attr.id]="id"\n\t[formControl]="control" [attr.type]="\'range\'" [attr.min]="schema.minimum" [attr.max]="schema.maximum" [disabled]="schema.readOnly?true:null" >\n\t<input *ngIf="schema.readOnly" [attr.name]="name" type="hidden">\n</div>'}]}],e}($),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.decorators=[{type:a.Component,args:[{selector:"sf-select-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n\n\t<span *ngIf="schema.description" class="formHelp">\n\t\t{{schema.description}}\n\t</span>\n\n\t<select *ngIf="schema.type!=\'array\'" [formControl]="control" [attr.name]="name" [disabled]="schema.readOnly" class="form-control">\n\t\t<option *ngFor="let option of schema.oneOf" [ngValue]="option.enum[0]" >{{option.description}}</option>\n\t</select>\n\n\t<select *ngIf="schema.type===\'array\'" multiple [formControl]="control" [attr.name]="name" [disabled]="schema.readOnly" class="form-control">\n\t\t<option *ngFor="let option of schema.items.oneOf" [ngValue]="option.enum[0]" >{{option.description}}</option>\n\t</select>\n\n\t<input *ngIf="schema.readOnly" [attr.name]="name" type="hidden" [formControl]="control">\n</div>'}]}],e}($),rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.getInputType=function(){return this.schema.widget.id&&"string"!==this.schema.widget.id?this.schema.widget.id:"text"},e.decorators=[{type:a.Component,args:[{selector:"sf-string-widget",template:'<input *ngIf="this.schema.widget.id ===\'hidden\'; else notHiddenFieldBlock"\n  [attr.name]="name" type="hidden" [formControl]="control">\n<ng-template #notHiddenFieldBlock>\n<div class="widget form-group">\n    <label [attr.for]="id" class="horizontal control-label">\n    \t{{ schema.title }}\n    </label>\n    <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n    <input [name]="name" [attr.readonly]="(schema.widget.id!==\'color\') && schema.readOnly?true:null"\n    class="text-widget.id textline-widget form-control"\n    [attr.type]="!this.schema.widget.id || this.schema.widget.id === \'string\' ? \'text\' : this.schema.widget.id"\n    [attr.id]="id"  [formControl]="control" [attr.placeholder]="schema.placeholder"\n    [attr.maxLength]="schema.maxLength || null"\n    [attr.minLength]="schema.minLength || null"\n    [attr.required]="schema.isRequired || null"\n    [attr.disabled]="(schema.widget.id==\'color\' && schema.readOnly)?true:null">\n    <input *ngIf="(schema.widget.id===\'color\' && schema.readOnly)" [attr.name]="name" type="hidden" [formControl]="control">\n</div>\n</ng-template>'}]}],e}($),nt=function(e){function t(){var t=e.call(this)||this;return t.register("array",U),t.register("object",Y),t.register("string",rt),t.register("search",rt),t.register("tel",rt),t.register("url",rt),t.register("email",rt),t.register("password",rt),t.register("color",rt),t.register("date",rt),t.register("date-time",rt),t.register("time",rt),t.register("integer",Z),t.register("number",Z),t.register("range",tt),t.register("textarea",Q),t.register("file",G),t.register("select",et),t.register("radio",X),t.register("boolean",J),t.register("checkbox",J),t.register("button",K),t.setDefaultWidget(rt),t}return c(t,e),t}(F),it=function(){function t(){}return t.decorators=[{type:a.Component,args:[{selector:"sf-default-field",template:"<p>Unknow type</p>"}]}],t}(),ot=[{provide:F,useClass:nt},{provide:R,useClass:E}],st=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:l(ot)}},t.decorators=[{type:a.NgModule,args:[{imports:[e.CommonModule,i.FormsModule,i.ReactiveFormsModule],declarations:[q,M,z,L,it,U,K,Y,J,G,Z,Q,X,tt,et,rt],entryComponents:[q,M,z,L,U,K,Y,J,G,Z,Q,X,tt,et,rt],exports:[z,q,M,L,U,K,Y,J,G,Z,Q,X,tt,et,rt]}]}],t}(),at=function(){function t(){this.changes=new a.EventEmitter}return t.prototype.changed=function(){this.changes.emit()},t}(),ct=function(){function t(){}return t.prototype.getTextContent=function(t){var e=Array.from(t.nativeElement.childNodes).filter(function(t){return t.nodeType===t.TEXT_NODE}).pop();return e&&e.nodeValue?e.nodeValue.trim():""},t}(),lt=function(r){function t(t){var e=r.call(this)||this;return e.elementRef=t,e.label="",e.click=new a.EventEmitter,e}return c(t,r),t.prototype.setLabelFromContent=function(){var t=this.getTextContent(this.elementRef);t&&!this.label&&(this.label=t)},t.prototype.ngAfterContentInit=function(){this.setLabelFromContent()},t.decorators=[{type:a.Component,args:[{selector:"sf-button",template:"<ng-content></ng-content>\n",providers:[{provide:ct,useExisting:a.forwardRef(function(){return t})}]}]}],t.ctorParameters=function(){return[{type:a.ElementRef}]},t.propDecorators={id:[{type:a.Input}],label:[{type:a.Input}],widget:[{type:a.Input}],click:[{type:a.Output}]},t}(ct),pt="string",ut="object",ht="array",dt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="",t}return c(t,e),Object.defineProperty(t.prototype,"path",{get:function(){return this.name?"/"+this.name:""},enumerable:!0,configurable:!0}),t.prototype.getButtons=function(){var i=this;return this.childButtons.map(function(t,e){if(!t.id){var r=Math.random().toString(16).substr(2,8);t.id=i.name+r+"_"+(e+1)}i.actionRegistry.register(t.id,t.click.emit.bind(t.click));var n={id:t.id,label:t.label};return t.widget&&(n.widget=t.widget),n})},t.prototype.getFieldsValidators=function(t){return t.reduce(function(t,e){return t.concat(e.getValidators())},[])},t.prototype.getFieldsSchema=function(t){var n=this;return t.reduce(function(t,e){switch(n.type){case ht:t.items=e.getSchema();break;default:t.properties||(t.properties={}),t.properties[e.name]=e.getSchema()}var r=e.getButtons();return 0<r.length&&(t.buttons=r),e.required&&(t.required||(t.required=[]),t.required.push(e.name)),t},{})},t}(ct),ft=function(r){function t(t){var e=r.call(this)||this;return e.elementRef=t,e}return c(t,r),t.prototype.ngOnInit=function(){this.description=this.getTextContent(this.elementRef)},t.decorators=[{type:a.Component,args:[{selector:"sf-item",template:"<ng-content></ng-content>\n"}]}],t.ctorParameters=function(){return[{type:a.ElementRef}]},t.propDecorators={value:[{type:a.Input}]},t}(ct),yt=function(i){function t(t,e,r){var n=i.call(this)||this;return n.elementRef=t,n.templateSchemaService=e,n.actionRegistry=r,n.type=pt,n.schema={},n}return c(t,i),t.prototype.getSchema=function(){var e=this,t=this.getFieldsSchema(this.childFields.filter(function(t){return t!==e})),r=t.properties,n=t.items,i=t.required,o=this.getOneOf(),s={type:this.type};this.title!==undefined&&(s.title=this.title),r!==undefined&&(s.properties=r),n!==undefined&&(s.items=n),i!==undefined&&(s.required=i),o!==undefined&&(s.oneOf=o),this.description!==undefined&&(s.description=this.description),this.placeholder!==undefined&&(s.placeholder=this.placeholder),this.format!==undefined&&(s.format=this.format),this.widget!==undefined&&(s.widget=this.widget),this.readOnly!==undefined&&(s.readOnly=this.readOnly);var a=this.getButtons();return 0<a.length&&(s.buttons=a),Object.assign(s,this.schema)},t.prototype.getValidators=function(){var n=this,t=this.getFieldsValidators(this.childFields.filter(function(t){return t!==n})).map(function(t){var e=t.path,r=t.validator;return{path:n.path+e,validator:r}});return this.validator&&t.push({path:this.path,validator:this.validator}),t},t.prototype.ngOnChanges=function(t){var e,r,n=Object.keys(t);if(0<n.length)try{for(var i=x(n),o=i.next();!o.done;o=i.next()){if(!t[o.value].isFirstChange()){this.templateSchemaService.changed();break}}}catch(s){e={error:s}}finally{try{o&&!o.done&&(r=i["return"])&&r.call(i)}finally{if(e)throw e.error}}},t.prototype.getOneOf=function(){if(0!==this.childItems.length){var t=this.childItems.map(function(t){var e=t.value,r=t.description;return Array.isArray(e)?{"enum":e,description:r}:{"enum":[e],description:r}});if(0!==t.length)return t}},t.prototype.setTitleFromContent=function(){var t=this.getTextContent(this.elementRef);t&&!this.title&&(this.title=t)},t.prototype.ngAfterContentInit=function(){var t=this;this.setTitleFromContent(),y.merge(this.childFields.changes,this.childItems.changes,this.childButtons.changes).subscribe(function(){return t.templateSchemaService.changed()})},t.decorators=[{type:a.Component,args:[{selector:"sf-field",template:"<ng-content ></ng-content>\n"}]}],t.ctorParameters=function(){return[{type:a.ElementRef},{type:at},{type:n}]},t.propDecorators={childFields:[{type:a.ContentChildren,args:[t]}],childItems:[{type:a.ContentChildren,args:[ft]}],childButtons:[{type:a.ContentChildren,args:[lt]}],name:[{type:a.Input}],type:[{type:a.Input}],format:[{type:a.Input}],required:[{type:a.Input}],readOnly:[{type:a.Input}],title:[{type:a.Input}],description:[{type:a.Input}],placeholder:[{type:a.Input}],widget:[{type:a.Input}],validator:[{type:a.Input}],schema:[{type:a.Input}]},t}(dt),mt=function(s){function t(t,e,r,n,i){var o=s.call(this)||this;return o.actionRegistry=t,o.validatorRegistry=e,o.formComponent=r,o.terminatorService=n,o.templateSchemaService=i,o}return c(t,s),t.prototype.setFormDocumentSchema=function(t){var n=this;this.actionRegistry.clear(),this.validatorRegistry.clear();var e=this.getFieldsSchema(t);this.getFieldsValidators(t).forEach(function(t){var e=t.path,r=t.validator;n.validatorRegistry.register(e,r)});var r=this.formComponent.schema;this.formComponent.schema={type:ut,properties:e.properties},e.required&&0<e.required.length&&(this.formComponent.schema.requred=e.required);var i=this.getButtons();0<i.length&&(this.formComponent.schema.buttons=i),this.formComponent.ngOnChanges({schema:new a.SimpleChange(r,this.formComponent.schema,Boolean(r))})},t.prototype.ngAfterContentInit=function(){var t=this;0<this.childFields.length&&this.setFormDocumentSchema(this.childFields.toArray()),y.merge(this.childFields.changes,this.templateSchemaService.changes).subscribe(function(){t.terminatorService.destroy(),t.setFormDocumentSchema(t.childFields.toArray())})},t.decorators=[{type:a.Directive,args:[{selector:"sf-form[templateSchema]",providers:[at]}]}],t.ctorParameters=function(){return[{type:n},{type:I},{type:z},{type:j},{type:at}]},t.propDecorators={childFields:[{type:a.ContentChildren,args:[yt]}],childButtons:[{type:a.ContentChildren,args:[lt]}]},t}(dt),gt=function(){function t(){}return t.decorators=[{type:a.NgModule,args:[{imports:[e.CommonModule],declarations:[mt,yt,lt,ft],exports:[mt,yt,lt,ft]}]}],t}();t.FormComponent=z,t.FormElementComponent=q,t.FormElementComponentAction=M,t.WidgetChooserComponent=L,t.WidgetRegistry=F,t.FormProperty=v,t.ArrayProperty=b,t.FormPropertyFactory=P,t.SchemaPreprocessor=C,t.ValidatorRegistry=I,t.ActionRegistry=n,t.BindingRegistry=_,t.SchemaValidatorFactory=R,t.ZSchemaValidatorFactory=E,t.WidgetFactory=k,t.TerminatorService=j,t.Widget=T,t.ControlWidget=$,t.ArrayLayoutWidget=H,t.ObjectLayoutWidget=N,t.ArrayWidget=U,t.ButtonWidget=K,t.ObjectWidget=Y,t.CheckboxWidget=J,t.FileWidget=G,t.IntegerWidget=Z,t.TextAreaWidget=Q,t.RadioWidget=X,t.RangeWidget=tt,t.SelectWidget=et,t.StringWidget=rt,t.DefaultWidgetRegistry=nt,t.SchemaFormModule=st,t.TemplateSchemaModule=gt,t.h=it,t.a=D,t.b=n,t.e=_,t.g=P,t.f=C,t.c=I,t.d=A,t.o=lt,t.j=dt,t.m=yt,t.n=ft,t.k=ct,t.i=mt,t.l=at,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-schema-form.umd.min.js.map