!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("rxjs"),require("rxjs/operators"),require("z-schema"),require("jexl"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-schema-form",["exports","@angular/core","@angular/forms","rxjs","rxjs/operators","z-schema","jexl","@angular/common"],e):e((t=t||self)["ngx-schema-form"]={},t.ng.core,t.ng.forms,t.rxjs,t.rxjs.operators,t.ZSchema,t.jexl,t.ng.common)}(this,(function(t,e,r,n,i,o,s,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function c(t,e){function r(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function p(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s}function u(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function h(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function f(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}var y=function(){function t(){this.actions={}}return t.prototype.clear=function(){this.actions={}},t.prototype.register=function(t,e){this.actions[t]=e},t.prototype.get=function(t){return this.actions[t]},t=p([e.Injectable()],t)}(),m=function(){function t(t,e,r,i,o,s){this.validatorRegistry=e,this.schema=i,this._value=null,this._errors=null,this._valueChanges=new n.BehaviorSubject(null),this._errorsChanges=new n.BehaviorSubject(null),this._visible=!0,this._visibilityChanges=new n.BehaviorSubject(!0),this.schemaValidator=t.createValidatorFn(this.schema),this.expressionCompilerVisibiltyIf=r.createExpressionCompilerVisibilityIf(),this._parent=o,o?this._root=o.root:this instanceof g&&(this._root=this,this._rootName=this.createRootName()),this._path=s}return Object.defineProperty(t.prototype,"_canonicalPath",{get:function(){return this.__canonicalPath},set:function(t){this.__canonicalPath=t,this.__canonicalPathNotation=(this.__canonicalPath||"").replace(new RegExp("^/","ig"),"").replace(new RegExp("/$","ig"),"").replace(new RegExp("/","ig"),".")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canonicalPathNotation",{get:function(){return this.__canonicalPathNotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootName",{get:function(){return this._rootName},enumerable:!0,configurable:!0}),t.prototype.createRootName=function(){return this.schema&&this.schema.name?this._rootName=this.schema.name.replace(new RegExp("[\\s]+","ig"),"_"):""},Object.defineProperty(t.prototype,"valueChanges",{get:function(){return this._valueChanges},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorsChanges",{get:function(){return this._errorsChanges},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.schema.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root||this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return null===this._errors},enumerable:!0,configurable:!0}),t.prototype.updateValueAndValidity=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!0),this._updateValue(),e&&this.valueChanges.next(this.value),this._runValidation(),this.parent&&!t&&this.parent.updateValueAndValidity(t,e)},t.prototype._runValidation=function(){var t=this.schemaValidator(this._value)||[],e=this.validatorRegistry.get(this.path);if(e){var r=e(this.value,this,this.findRoot());t=this.mergeErrors(t,r)}0===t.length&&(t=null),this._errors=t,this.setErrors(this._errors)},t.prototype.mergeErrors=function(t,e){return e&&(Array.isArray(e)?t=t.concat.apply(t,f(e)):t.push(e)),t},t.prototype.setErrors=function(t){this._errors=t,this._errorsChanges.next(t)},t.prototype.extendErrors=function(t){t=this.mergeErrors(this._errors||[],t),this.setErrors(t)},t.prototype.searchProperty=function(t){var e=this,r=null,n=null;if("/"===t[0])n=(r=this.findRoot()).getProperty(t.substr(1));else for(;null===n&&null!==e.parent;)e=r=e.parent,n=r.getProperty(t);return n},t.prototype.findRoot=function(){for(var t=this;null!==t.parent;)t=t.parent;return t},t.prototype.setVisible=function(t){this._visible=t,this._visibilityChanges.next(t),this.updateValueAndValidity(),this.parent&&this.parent.updateValueAndValidity(!1,!0)},t.prototype.__evaluateVisibilityIf=function(t,e,r,n,i){var o,s;void 0===n&&(n=""),void 0===i&&(i="");try{var a=!1;if(isNaN(i)&&-1!==i.indexOf("$ANY$"))a=n&&n.length>0;else if(0===(i||[]).toString().indexOf("$EXP$")){var l=Array.isArray(i)?i:i?[i]:[];try{for(var c=h(l),p=c.next();!p.done;p=c.next()){var u=p.value.substring("$EXP$".length);if(a=!0===this.expressionCompilerVisibiltyIf.evaluate(u,{source:t,target:e}))break}}catch(t){o={error:t}}finally{try{p&&!p.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}}else a=isNaN(n)?-1!==n.indexOf(i):n===i;return a}catch(o){console.error('Error processing "VisibileIf" expression for path: ',r,"source - "+t._canonicalPath+": ",t,"target - "+e._canonicalPath+": ",e,"value:",n,"expression: ",i,"error: ",o)}},t.prototype.__bindVisibility=function(){var t,e,r=this,o=this.schema.visibleIf,s=(o||{}).oneOf||(o||{}).allOf;if(s){var a=function(t){if("object"==typeof t&&0===Object.keys(t).length)l.setVisible(!1);else if(void 0!==t){var e=[],o=function(o){var s,a;if(t.hasOwnProperty(o)){var c=l.findProperties(l,o);if((c||[]).length){var p=function(s){if(s){var a=void 0;if(l.schema.visibleIf.oneOf)a=s.valueChanges.pipe(i.map((function(e){return r.__evaluateVisibilityIf(r,s,o,e,t[o])})));else if(l.schema.visibleIf.allOf){a=s.valueChanges.pipe(i.map((function(t){var e,n,i,s;try{for(var a=(e=void 0,h(r.schema.visibleIf.allOf)),l=a.next();!l.done;l=a.next()){var c=l.value;try{for(var p=(i=void 0,h(Object.keys(c))),u=p.next();!u.done;u=p.next()){var d=u.value,f=r.searchProperty(d),y=f.value;if(!r.__evaluateVisibilityIf(r,f,o,y,c[d]))return!1}}catch(t){i={error:t}}finally{try{u&&!u.done&&(s=p.return)&&s.call(p)}finally{if(i)throw i.error}}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return!0})))}var c=s._visibilityChanges,p=n.combineLatest([a,c],(function(t,e){return t&&e}));e.push(p)}};try{for(var u=(s=void 0,h(c)),d=u.next();!d.done;d=u.next()){p(d.value)}}catch(t){s={error:t}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(s)throw s.error}}}else console.warn("Can't find property "+o+" for visibility check of "+l.path),l.registerMissingVisibilityBinding(o,l),l.setVisible(!1)}};for(var s in t)o(s);n.combineLatest(e,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return-1!==t.indexOf(!0)})).pipe(i.distinctUntilChanged()).subscribe((function(t){r.setVisible(t)}))}},l=this;try{for(var c=h(s),p=c.next();!p.done;p=c.next()){a(p.value)}}catch(e){t={error:e}}finally{try{p&&!p.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}return!0}},t.prototype._bindVisibility=function(){var t=this;if(!this.__bindVisibility()){var e=this.schema.visibleIf;if("object"==typeof e&&0===Object.keys(e).length)this.setVisible(!1);else if(void 0!==e){var r=[],o=function(o){var a,l;if(e.hasOwnProperty(o)){var c=s.findProperties(s,o);if((c||[]).length){var p=function(s){if(s){var a=s.valueChanges.pipe(i.map((function(r){return t.__evaluateVisibilityIf(t,s,o,r,e[o])}))),l=s._visibilityChanges,c=n.combineLatest([a,l],(function(t,e){return t&&e}));r.push(c)}};try{for(var u=(a=void 0,h(c)),d=u.next();!d.done;d=u.next()){p(d.value)}}catch(t){a={error:t}}finally{try{d&&!d.done&&(l=u.return)&&l.call(u)}finally{if(a)throw a.error}}}else console.warn("Can't find property "+o+" for visibility check of "+s.path),s.registerMissingVisibilityBinding(o,s),s.setVisible(!1)}},s=this;for(var a in e)o(a);n.combineLatest(r,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return-1!==t.indexOf(!0)})).pipe(i.distinctUntilChanged()).subscribe((function(e){t.setVisible(e)}))}}},t.prototype.registerMissingVisibilityBinding=function(t,e){e._propertyBindingRegistry.getPropertyBindingsVisibility().add(t,e.path)},t.prototype.findProperties=function(t,e){var r,n,i=[],o=this.findPropertyPaths(t,e);try{for(var s=h(o),a=s.next();!a.done;a=s.next()){var l=a.value,c=t.searchProperty(l);c&&i.push(c)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i},t.prototype.findPropertyPaths=function(t,e,r){var n=e.indexOf("*");if(-1!==n){var i=n>-1?e.substring(0,n-1):e,o=n>-1?e.substring(n+1):e,s=t.searchProperty(i),a=[];if(s instanceof g)for(var l=s.properties,c=0;c<l.length;c++){var p=(r||"")+i+(i.endsWith("/")?"":"/")+c+o,u=(r||"")+i+c;-1===p.indexOf("*")&&a.push(p);var h=this.findPropertyPaths(l[c],o,u);a=a.concat(h)}return a}return[e]},t}(),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._properties=null,e._propertyProxyHandler={set:function(t,e,r,n){var i=function(r){var n,i,o=r;if(Array.isArray(t)&&r instanceof m){o&&(o._canonicalPath=function(t,e){var r;if(t&&-1!==(r=t.lastIndexOf("*")))return t.substring(0,r)+e.toString()+t.substring(r+1)}(o._canonicalPath,e))}var s=o,a=Array.isArray(s.properties)?s.properties:Object.values(s.properties||{});if((o.path||"").endsWith("/*"))try{for(var l=h(a),c=l.next();!c.done;c=l.next()){var p=c.value;p._canonicalPath=o._canonicalPath+p._canonicalPath.substring(o.path.length)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return{property:o,children:a}}(r),o=i.property,s=i.children,a=t[e]=r;return function(){var t,e,r,n,i=[o].concat(s),a=function(t){var e,r,n=t._propertyBindingRegistry.getPropertyBindingsVisibility(),i=[];t._canonicalPath&&(i=i.concat(i.concat(n.findByDependencyPath(t._canonicalPath)||[])),t._canonicalPath.startsWith("/")&&(i=i.concat(i.concat(n.findByDependencyPath(t._canonicalPath.substring(1))||[])))),i=i.concat(n.findByDependencyPath(t.path)||[]),t.path.startsWith("/")&&(i=i.concat(i.concat(n.findByDependencyPath(t.path.substring(1))||[])));var o={};try{for(var s=h(i),a=s.next();!a.done;a=s.next()){var l=a.value;o[l]=l}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return Object.keys(o)};try{for(var l=h(i),c=l.next();!c.done;c=l.next()){var p=c.value;if(p instanceof m)try{var u=a(p);try{for(var d=(r=void 0,h(u)),f=d.next();!f.done;f=d.next()){var y=f.value;p.searchProperty(y)._bindVisibility()}}catch(t){r={error:t}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}}catch(t){console.error("Rebinding visibility error at path:",p.path,"property:",p,t)}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}}(),a},get:function(t,e,r){return t[e]},deleteProperty:function(t,e){return delete t[e]}},e}return c(e,t),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},set:function(t){this._properties=new Proxy(t,this._propertyProxyHandler)},enumerable:!0,configurable:!0}),e.prototype.getProperty=function(t){var r=t.indexOf("/"),n=-1!==r?t.substr(0,r):t,i=this.properties[n];if(null!==i&&-1!==r&&i instanceof e){var o=t.substr(r+1);i=i.getProperty(o)}return i},e.prototype.forEachChild=function(t){for(var e in this.properties){if(this.properties.hasOwnProperty(e))t(this.properties[e],e)}},e.prototype.forEachChildRecursive=function(t){this.forEachChild((function(r){t(r),r instanceof e&&r.forEachChildRecursive(t)}))},e.prototype._bindVisibility=function(){t.prototype._bindVisibility.call(this),this._bindVisibilityRecursive()},e.prototype._bindVisibilityRecursive=function(){this.forEachChildRecursive((function(t){t._bindVisibility()}))},e.prototype.isRoot=function(){return this===this.root},e}(m),v={},b=function(){function t(t,e,r,n){this.schemaValidatorFactory=t,this.validatorRegistry=e,this.propertyBindingRegistry=r,this.expressionCompilerFactory=n}return t.prototype.createProperty=function(t,e,r){void 0===e&&(e=null);var n=null,i="",o="";if(e){if(i+=e.path,null!==e.parent&&(i+="/",o+="/"),"object"===e.type)i+=r,o+=r;else{if("array"!==e.type)throw"Instanciation of a FormProperty with an unknown parent type: "+e.type;i+="*",o+="*"}o=(e._canonicalPath||e.path)+o}else i="/",o="/";if(t.$ref){var s=this.schemaValidatorFactory.getSchema(e.root.schema,t.$ref);n=this.createProperty(s,e,i)}else{if(!v[t.type])throw new TypeError("Undefined type "+t.type+" (existing: "+Object.keys(v)+")");n="object"===t.type||"array"===t.type?v[t.type](this.schemaValidatorFactory,this.validatorRegistry,this.expressionCompilerFactory,t,e,i,this):v[t.type](this.schemaValidatorFactory,this.validatorRegistry,this.expressionCompilerFactory,t,e,i)}return n._propertyBindingRegistry=this.propertyBindingRegistry,n._canonicalPath=o,n instanceof g&&this.initializeRoot(n),n},t.prototype.initializeRoot=function(t){t.reset(null,!0),t._bindVisibility()},t}();function P(t,e){return"Parsing error on "+e+": "+t}function w(t,e){var r=P(t,e);throw new Error(r)}function C(t,e){var r=P(t,e);throw new Error(r)}var O,x=function(){function t(){}var r;return r=t,t.preprocess=function(t,e){void 0===e&&(e="/"),t=t||{},r.normalizeExtensions(t),"object"===t.type?(r.checkProperties(t,e),r.checkAndCreateFieldsets(t,e)):"array"===t.type&&r.checkItems(t,e),r.normalizeWidget(t),r.recursiveCheck(t,e)},t.checkProperties=function(t,e){null==t.properties&&(t.properties={},C("Provided json schema does not contain a 'properties' entry. Output schema will be empty",e))},t.checkAndCreateFieldsets=function(t,e){void 0===t.fieldsets&&(void 0!==t.order?r.replaceOrderByFieldsets(t):r.createFieldsets(t)),r.checkFieldsUsage(t,e)},t.checkFieldsUsage=function(t,e){var r,n,i,o,s,a,l=Object.keys(t.properties),c={};try{for(var p=h(t.fieldsets),u=p.next();!u.done;u=p.next()){var d=u.value;try{for(var f=(i=void 0,h(d.fields)),y=f.next();!y.done;y=f.next()){void 0===c[v=y.value]&&(c[v]=[]),c[v].push(d.id)}}catch(t){i={error:t}}finally{try{y&&!y.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}try{for(var m=h(l),g=m.next();!g.done;g=m.next()){var v=g.value,b=t.required&&t.required.indexOf(v)>-1;b&&t.properties[v]&&(t.properties[v].isRequired=!0),c.hasOwnProperty(v)?(c[v].length>1&&w(v+" is referenced by more than one fieldset: "+c[v],e),delete c[v]):b?w(v+" is a required field but it is not referenced as part of a 'order' or a 'fieldset' property",e):(delete t[v],C("Removing unreferenced field "+v,e))}}catch(t){s={error:t}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(s)throw s.error}}for(var P in c)c.hasOwnProperty(P)&&C("Referencing non-existent field "+P+" in one or more fieldsets",e)},t.createFieldsets=function(t){t.order=Object.keys(t.properties),r.replaceOrderByFieldsets(t)},t.replaceOrderByFieldsets=function(t){t.fieldsets=[{id:"fieldset-default",title:t.title||"",description:t.description||"",name:t.name||"",fields:t.order}],delete t.order},t.normalizeWidget=function(t){var e=t.widget;void 0===e?e={id:t.type}:"string"==typeof e&&(e={id:e}),t.widget=e},t.checkItems=function(t,e){void 0===t.items&&w("No 'items' property in array",e)},t.recursiveCheck=function(t,e){if("object"===t.type){for(var n in t.properties)if(t.properties.hasOwnProperty(n)){var i=t.properties[n];r.preprocess(i,e+n+"/")}if(t.hasOwnProperty("definitions"))for(var n in t.definitions)if(t.definitions.hasOwnProperty(n)){i=t.definitions[n];r.removeRecursiveRefProperties(i,"#/definitions/"+n),r.preprocess(i,e+n+"/")}}else"array"===t.type&&r.preprocess(t.items,e+"*/")},t.removeRecursiveRefProperties=function(t,e){if("object"===t.type)for(var n in t.properties)t.properties.hasOwnProperty(n)&&(t.properties[n].$ref&&t.properties[n].$ref===e?delete t.properties[n]:"object"===t.properties[n].type&&r.removeRecursiveRefProperties(t.properties[n],e))},t.normalizeExtensions=function(t){for(var e=[{name:"fieldsets",regex:/^x-?field-?sets$/i},{name:"widget",regex:/^x-?widget$/i},{name:"visibleIf",regex:/^x-?visible-?if$/i}],r=Object.keys(t),n=function(n){var i=r[n],o=e.find((function(t){return!!i.match(t.regex)}));if(o){var s=t[i],a=JSON.parse(JSON.stringify(s));t[o.name]=a}},i=0;i<r.length;++i)n(i)},t=r=p([e.Injectable()],t)}(),I=function(){function t(){this.validators=[]}return t.prototype.register=function(t,e){this.validators[t]=e},t.prototype.get=function(t){return this.validators[t]},t.prototype.clear=function(){this.validators=[]},t=p([e.Injectable()],t)}(),_=function(){function t(){this.bindings=[]}return t.prototype.clear=function(){this.bindings=[]},t.prototype.register=function(t,e){this.bindings[t]=[].concat(e)},t.prototype.get=function(t){return this.bindings[t]},t=p([e.Injectable()],t)}(),V=function(){function t(){}return t.prototype.reset=function(){},t}(),R=function(t){function r(){var e=t.call(this)||this;return e.createSchemaValidator(),e}return c(r,t),r.prototype.createSchemaValidator=function(){this.zschema=new o({breakOnFirstError:!1})},r.prototype.reset=function(){this.createSchemaValidator()},r.prototype.createValidatorFn=function(t){var e=this;return function(r){"number"!==t.type&&"integer"!==t.type||(r=+r),e.zschema.validate(r,t);var n=e.zschema.getLastErrors();return e.denormalizeRequiredPropertyPaths(n),n||null}},r.prototype.getSchema=function(t,e){if(this.zschema.compileSchema(t))return this.getDefinition(t,e);throw this.zschema.getLastError()},r.prototype.denormalizeRequiredPropertyPaths=function(t){t&&t.length&&(t=t.map((function(t){return"#/"===t.path&&"OBJECT_MISSING_REQUIRED_PROPERTY"===t.code&&(t.path=""+t.path+t.params[0]),t})))},r.prototype.getDefinition=function(t,e){var r=t;return e.split("/").slice(1).forEach((function(t){t&&(r=r[t])})),r},r=p([e.Injectable(),u("design:paramtypes",[])],r)}(V),j=function(){function t(){this.widgets={}}return t.prototype.setDefaultWidget=function(t){this.defaultWidget=t},t.prototype.getDefaultWidget=function(){return this.defaultWidget},t.prototype.hasWidget=function(t){return this.widgets.hasOwnProperty(t)},t.prototype.register=function(t,e){this.widgets[t]=e},t.prototype.getWidgetType=function(t){return this.hasWidget(t)?this.widgets[t]:this.defaultWidget},t}(),E=function(){function t(t,e){this.registry=t,this.resolver=e}return t.prototype.createWidget=function(t,e){var r=this.registry.getWidgetType(e),n=this.resolver.resolveComponentFactory(r);return t.createComponent(n)},t.ctorParameters=function(){return[{type:j},{type:e.ComponentFactoryResolver}]},t=p([e.Injectable(),u("design:paramtypes",[j,e.ComponentFactoryResolver])],t)}(),F=function(){function t(){this.onDestroy=new n.Subject}return t.prototype.destroy=function(){this.onDestroy.next(!0)},t=p([e.Injectable(),u("design:paramtypes",[])],t)}(),k=function(){function t(){this.bindings={}}return t.prototype.getPropertyBindings=function(t){return this.bindings[t]=this.bindings[t]||new S,this.bindings[t]},t.prototype.getPropertyBindingsVisibility=function(){return this.getPropertyBindings(O.visibility)},t=p([e.Injectable()],t)}();!function(t){t[t.visibility=0]="visibility"}(O||(O={}));var S=function(){function t(){this.sourcesIndex=new A,this.dependenciesIndex=new A}return t.prototype.add=function(t,e){this.sourcesIndex.store(e,t),this.dependenciesIndex.store(t,e)},t.prototype.findByDependencyPath=function(t){var e,r,n=this.dependenciesIndex.find(t);n.results=n.results||[];var i=[];try{for(var o=h(n.results),s=o.next();!s.done;s=o.next()){var a=s.value;i=i.concat(Object.keys(a.value))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n.found?i:[]},t.prototype.getBySourcePropertyPath=function(t){var e,r,n=this.sourcesIndex.find(t);n.results=n.results||[];var i=[];try{for(var o=h(n.results),s=o.next();!s.done;s=o.next()){var a=s.value;i=i.concat(Object.keys(a.value))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n.found?i:[]},t.prototype.createPathIndex=function(t){return t.split("/")},t}(),A=function(){function t(){this.index={},this.findOnlyWithValue=!0}return t.prototype._createPathIndex=function(t){return t.replace(new RegExp("//","g"),"/").replace(new RegExp("^/","g"),"").split("/").filter((function(t){return t}))},t.prototype.store=function(t,e){this._storeIndex(this._createPathIndex(t),e)},t.prototype._storeIndex=function(e,r){var n,i,o=this.index;try{for(var s=h(e),a=s.next();!a.done;a=s.next()){var l=a.value;o[l]=o[l]||{},o=o[l]}}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}o&&r&&(o[t.MARKER]=o[t.MARKER]||{},o[t.MARKER][r]=r)},t.prototype.find=function(t){return this._findInIndex(this._createPathIndex(t))},t.prototype._findInIndex=function(t){var e={target:t,found:!1,results:[]};return this.__findIndex(e,t,this.index,[]),e},t.prototype.__findIndex=function(e,r,n,i){var o,s,a=i||[],l=r[0],c="*"===l?Object.keys(n):[],p=(Array.isArray(l)?l:[l]).concat(c),u=p.filter((function(t,e){return"*"!==t&&p.indexOf(t)===e}));n["*"]&&u.push("*");var d=[];try{for(var f=h(u),y=f.next();!y.done;y=f.next()){var m=y.value,g=r.slice(1),v=n[m],b=a.concat(m);if(1===r.length&&(!this.findOnlyWithValue||v&&v[t.MARKER])&&(e.results=e.results||[],e.results.push({path:b,value:v[t.MARKER]}),d.push(b),e.found=e.results.length>0),!g||!g.length||!v)break;var P=this.__findIndex(e,g,v,b);d=d.concat(P)}}catch(t){o={error:t}}finally{try{y&&!y.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}return d},t.MARKER="$____value",t}(),B=function(){},D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.createExpressionCompiler=function(){return new W},e.prototype.createExpressionCompilerVisibilityIf=function(){return new N},e}(B),W=function(){function t(){}return t.prototype.evaluate=function(t,e){return void 0===e&&(e={}),(new s.Jexl).evalSync(t,e)},t}(),N=function(){function t(){}return t.prototype.evaluate=function(t,e){return void 0===e&&(e={source:{},target:{}}),(new s.Jexl).evalSync(t,e)},t}();function z(t,e,r,n){return new b(t,e,r,n)}var L=function(){function t(t,r,n,i,o,s){this.formPropertyFactory=t,this.actionRegistry=r,this.validatorRegistry=n,this.bindingRegistry=i,this.cdr=o,this.terminator=s,this.schema=null,this.actions={},this.validators={},this.bindings={},this.onChange=new e.EventEmitter,this.modelChange=new e.EventEmitter,this.isValid=new e.EventEmitter,this.onErrorChange=new e.EventEmitter,this.onErrorsChange=new e.EventEmitter,this.rootProperty=null}var n;return n=t,t.prototype.writeValue=function(t){this.rootProperty&&this.rootProperty.reset(t,!1)},t.prototype.registerOnChange=function(t){this.onChangeCallback=t,this.rootProperty&&this.rootProperty.valueChanges.subscribe(this.onValueChanges.bind(this))},t.prototype.registerOnTouched=function(t){},t.prototype.ngOnChanges=function(t){var e=this;t.validators&&this.setValidators(),t.actions&&this.setActions(),t.bindings&&this.setBindings(),this.schema&&!this.schema.type&&(this.schema.type="object"),this.schema&&t.schema&&(t.schema.firstChange||this.terminator.destroy(),x.preprocess(this.schema),this.rootProperty=this.formPropertyFactory.createProperty(this.schema),this.model,this.rootProperty.valueChanges.subscribe(this.onValueChanges.bind(this)),this.rootProperty.errorsChanges.subscribe((function(t){e.onErrorChange.emit({value:t}),e.isValid.emit(!(t&&t.length))}))),this.schema&&(t.model||t.schema)&&(this.rootProperty.reset(this.model,!1),this.cdr.detectChanges())},t.prototype.setValidators=function(){if(this.validatorRegistry.clear(),this.validators)for(var t in this.validators)this.validators.hasOwnProperty(t)&&this.validatorRegistry.register(t,this.validators[t])},t.prototype.setActions=function(){if(this.actionRegistry.clear(),this.actions)for(var t in this.actions)this.actions.hasOwnProperty(t)&&this.actionRegistry.register(t,this.actions[t])},t.prototype.setBindings=function(){if(this.bindingRegistry.clear(),this.bindings)for(var t in this.bindings)this.bindings.hasOwnProperty(t)&&this.bindingRegistry.register(t,this.bindings[t])},t.prototype.reset=function(){this.rootProperty.reset(null,!0)},t.prototype.setModel=function(t){this.model?Object.assign(this.model,t):this.model=t},t.prototype.onValueChanges=function(t){this.onChangeCallback&&(this.setModel(t),this.onChangeCallback(t)),this.modelChange.observers.length>0&&(this.onChangeCallback||this.setModel(t)),this.onChange.emit({value:t})},t.ctorParameters=function(){return[{type:b},{type:y},{type:I},{type:_},{type:e.ChangeDetectorRef},{type:F}]},p([e.Input(),u("design:type",Object)],t.prototype,"schema",void 0),p([e.Input(),u("design:type",Object)],t.prototype,"model",void 0),p([e.Input(),u("design:type",Object)],t.prototype,"actions",void 0),p([e.Input(),u("design:type",Object)],t.prototype,"validators",void 0),p([e.Input(),u("design:type",Object)],t.prototype,"bindings",void 0),p([e.Output(),u("design:type",Object)],t.prototype,"onChange",void 0),p([e.Output(),u("design:type",Object)],t.prototype,"modelChange",void 0),p([e.Output(),u("design:type",Object)],t.prototype,"isValid",void 0),p([e.Output(),u("design:type",Object)],t.prototype,"onErrorChange",void 0),p([e.Output(),u("design:type",Object)],t.prototype,"onErrorsChange",void 0),t=n=p([e.Component({selector:"sf-form",template:'\n    <form *ngIf="rootProperty" [attr.name]="rootProperty.rootName" [attr.id]="rootProperty.rootName">\n      <sf-form-element [formProperty]="rootProperty"></sf-form-element>\n    </form>',providers:[y,I,k,_,x,E,{provide:b,useFactory:z,deps:[V,I,k,B]},F,{provide:r.NG_VALUE_ACCESSOR,useExisting:n,multi:!0}]}),u("design:paramtypes",[b,y,I,_,e.ChangeDetectorRef,F])],t)}(),q=function(){function t(t,e,n,i){this.actionRegistry=t,this.bindingRegistry=e,this.renderer=n,this.elementRef=i,this.control=new r.FormControl("",(function(){return null})),this.widget=null,this.buttons=[],this.unlisten=[]}var n;return n=t,t.prototype.ngOnInit=function(){this.parseButtons(),this.setupBindings()},t.prototype.setupBindings=function(){var t=this,e=this.bindingRegistry.get(this.formProperty.path);(e||[]).length&&e.forEach((function(e){for(var r in e)t.createBinding(r,e[r])}))},t.prototype.createBinding=function(t,e){var r=this;this.unlisten.push(this.renderer.listen(this.elementRef.nativeElement,t,(function(n){e instanceof Function?e(n,r.formProperty):console.warn("Calling non function handler for eventId "+t+" for path "+r.formProperty.path)})))},t.prototype.parseButtons=function(){var t,e;if(void 0!==this.formProperty.schema.buttons){this.buttons=this.formProperty.schema.buttons;try{for(var r=h(this.buttons),n=r.next();!n.done;n=r.next()){var i=n.value;this.createButtonCallback(i)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}}},t.prototype.createButtonCallback=function(t){var e=this;t.action=function(r){var n;t.id&&(n=e.actionRegistry.get(t.id))&&n&&n(e.formProperty,t.parameters),r.preventDefault()}},t.prototype.onWidgetInstanciated=function(t){this.widget=t;var e=this.formProperty.canonicalPathNotation||"field"+n.counter++;this.formProperty.root.rootName&&(e=this.formProperty.root.rootName+":"+e),this.widget.formProperty=this.formProperty,this.widget.schema=this.formProperty.schema,this.widget.name=e,this.widget.id=e,this.widget.control=this.control},t.prototype.ngOnDestroy=function(){this.unlisten&&this.unlisten.forEach((function(t){t()}))},t.counter=0,t.ctorParameters=function(){return[{type:y},{type:_},{type:e.Renderer2},{type:e.ElementRef}]},p([e.Input(),u("design:type",m)],t.prototype,"formProperty",void 0),t=n=p([e.Component({selector:"sf-form-element",template:'\n    <div *ngIf="formProperty.visible"\n         [class.has-error]="!control.valid"\n         [class.has-success]="control.valid">\n      <sf-widget-chooser\n        (widgetInstanciated)="onWidgetInstanciated($event)"\n        [widgetInfo]="formProperty.schema.widget">\n      </sf-widget-chooser>\n      <sf-form-element-action *ngFor="let button of buttons" [button]="button" [formProperty]="formProperty"></sf-form-element-action>\n    </div>'}),u("design:paramtypes",[y,_,e.Renderer2,e.ElementRef])],t)}(),M=function(){function t(t,e){void 0===t&&(t=null),this.widgetFactory=t,this.terminator=e}return t.prototype.ngOnInit=function(){var t=this;this.subs=this.terminator.onDestroy.subscribe((function(e){e&&t.ref.destroy()}))},t.prototype.ngOnChanges=function(){this.ref=this.widgetFactory.createWidget(this.container,this.button.widget||"button"),this.ref.instance.button=this.button,this.ref.instance.formProperty=this.formProperty},t.prototype.ngOnDestroy=function(){this.subs.unsubscribe()},t.ctorParameters=function(){return[{type:E},{type:F}]},p([e.Input(),u("design:type",Object)],t.prototype,"button",void 0),p([e.Input(),u("design:type",Object)],t.prototype,"formProperty",void 0),p([e.ViewChild("target",{read:e.ViewContainerRef,static:!0}),u("design:type",e.ViewContainerRef)],t.prototype,"container",void 0),t=p([e.Component({selector:"sf-form-element-action",template:"<ng-template #target></ng-template>"}),u("design:paramtypes",[E,F])],t)}(),T=function(){function t(t,r,n){void 0===t&&(t=null),this.widgetFactory=t,this.cdr=r,this.terminator=n,this.widgetInstanciated=new e.EventEmitter}return t.prototype.ngOnInit=function(){var t=this;this.subs=this.terminator.onDestroy.subscribe((function(e){e&&t.ref.destroy()}))},t.prototype.ngOnChanges=function(){this.ref=this.widgetFactory.createWidget(this.container,this.widgetInfo.id),this.widgetInstanciated.emit(this.ref.instance),this.widgetInstance=this.ref.instance,this.cdr.detectChanges()},t.prototype.ngOnDestroy=function(){this.subs.unsubscribe()},t.ctorParameters=function(){return[{type:E},{type:e.ChangeDetectorRef},{type:F}]},p([e.Input(),u("design:type",Object)],t.prototype,"widgetInfo",void 0),p([e.Output(),u("design:type",Object)],t.prototype,"widgetInstanciated",void 0),p([e.ViewChild("target",{read:e.ViewContainerRef,static:!0}),u("design:type",e.ViewContainerRef)],t.prototype,"container",void 0),t=p([e.Component({selector:"sf-widget-chooser",template:"<div #target></div>"}),u("design:paramtypes",[E,e.ChangeDetectorRef,F])],t)}(),$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.setValue=function(t,e){void 0===e&&(e=!1),this._value=t,this.updateValueAndValidity(e,!0)},e.prototype.reset=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!0),this.resetValue(t),this.updateValueAndValidity(e,!0)},e.prototype.resetValue=function(t){null===t&&(t=void 0!==this.schema.default?this.schema.default:this.fallbackValue()),this._value=t},e.prototype._hasValue=function(){return this.fallbackValue()!==this.value},e.prototype._updateValue=function(){},e}(m),H=function(t){function e(e,r,n,i,o,s,a){var l=t.call(this,r,n,i,o,s,a)||this;return l.formPropertyFactory=e,l.propertiesId=[],l.createProperties(),l}return c(e,t),e.prototype.setValue=function(t,e){for(var r in t)t.hasOwnProperty(r)&&this.properties[r].setValue(t[r],!0);this.updateValueAndValidity(e,!0)},e.prototype.reset=function(t,e){void 0===e&&(e=!0),t=t||this.schema.default||{},this.resetProperties(t),this.updateValueAndValidity(e,!0)},e.prototype.resetProperties=function(t){for(var e in this.schema.properties)this.schema.properties.hasOwnProperty(e)&&this.properties[e].reset(t[e],!0)},e.prototype.createProperties=function(){for(var t in this.properties={},this.propertiesId=[],this.schema.properties)if(this.schema.properties.hasOwnProperty(t)){var e=this.schema.properties[t];this.properties[t]=this.formPropertyFactory.createProperty(e,this,t),this.propertiesId.push(t)}},e.prototype._hasValue=function(){return!!Object.keys(this.value).length},e.prototype._updateValue=function(){this.reduceValue()},e.prototype._runValidation=function(){var e=this;t.prototype._runValidation.call(this),this._errors&&this._errors.forEach((function(t){var r=e.searchProperty(t.path.slice(1));r&&r.extendErrors(t)}))},e.prototype.reduceValue=function(){var t={};this.forEachChild((function(e,r){e.visible&&e._hasValue()&&(t[r]=e.value)})),this._value=t},e}(g);v.object=function(t,e,r,n,i,o,s){return new H(s,t,e,r,n,i,o)};var U=function(t){function e(e,r,n,i,o,s,a){var l=t.call(this,r,n,i,o,s,a)||this;return l.formPropertyFactory=e,l}return c(e,t),e.prototype.addItem=function(t){void 0===t&&(t=null);var e=this.addProperty();return e.reset(t,!1),e},e.prototype.addProperty=function(){var t=this.formPropertyFactory.createProperty(this.schema.items,this);return this.properties.push(t),t},e.prototype.removeItem=function(t){this.properties=this.properties.filter((function(e){return e!==t})),this.updateValueAndValidity(!1,!0)},e.prototype.setValue=function(t,e){this.createProperties(),this.resetProperties(t),this.updateValueAndValidity(e,!0)},e.prototype._hasValue=function(){return!0},e.prototype._updateValue=function(){this.reduceValue()},e.prototype.reduceValue=function(){var t=[];this.forEachChild((function(e,r){e.visible&&e._hasValue()&&t.push(e.value)})),this._value=t},e.prototype.reset=function(t,e){void 0===e&&(e=!0),t=t||this.schema.default||[],this.properties=[],this.resetProperties(t),this.updateValueAndValidity(e,!0)},e.prototype.createProperties=function(){this.properties=[]},e.prototype.resetProperties=function(t){for(var e in t){if(t.hasOwnProperty(e))this.addProperty().reset(t[e],!0)}},e}(g);v.array=function(t,e,r,n,i,o,s){return new U(s,t,e,r,n,i,o)};var K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.fallbackValue=function(){return""},e}($);v.string=function(t,e,r,n,i,o){return new K(t,e,r,n,i,o)};var Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.fallbackValue=function(){return null},e}($);v.boolean=function(t,e,r,n,i,o){return new Q(t,e,r,n,i,o)};var J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.fallbackValue=function(){return null},e.prototype.setValue=function(t,e){void 0===e&&(e=!1),"string"==typeof t&&(t=t.length?t.indexOf(".")>-1?parseFloat(t):parseInt(t,10):null),this._value=t,this.updateValueAndValidity(e,!0)},e}($);v.integer=function(t,e,r,n,i,o){return new J(t,e,r,n,i,o)},v.number=function(t,e,r,n,i,o){return new J(t,e,r,n,i,o)};var X,G=function(){this.id="",this.name="",this.schema={}},Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.ngAfterViewInit=function(){var t=this,e=this.control;this.formProperty.valueChanges.subscribe((function(t){e.value!==t&&e.setValue(t,{emitEvent:!1})})),this.formProperty.errorsChanges.subscribe((function(r){e.setErrors(r,{emitEvent:!0});var n=(r||[]).filter((function(e){return e.path&&e.path.slice(1)===t.formProperty.path})).map((function(t){return t.message}));t.errorMessages=n.filter((function(t,e){return n.indexOf(t)===e}))})),e.valueChanges.subscribe((function(e){t.formProperty.setValue(e,!1)}))},e}(G),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.ngAfterViewInit=function(){var t=this.control;this.formProperty.errorsChanges.subscribe((function(e){t.setErrors(e,{emitEvent:!0})}))},e}(G),tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return c(e,t),e.prototype.ngAfterViewInit=function(){var t=this.control;this.formProperty.errorsChanges.subscribe((function(e){t.setErrors(e,{emitEvent:!0})}))},e}(G),et=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return c(r,t),r.prototype.addItem=function(){this.formProperty.addItem(),this.updateButtonDisabledState()},r.prototype.removeItem=function(t){this.formProperty.removeItem(t),this.updateButtonDisabledState()},r.prototype.trackByIndex=function(t,e){return t},r.prototype.updateButtonDisabledState=function(){this.buttonDisabledAdd=this.isAddButtonDisabled(),this.buttonDisabledRemove=this.isRemoveButtonDisabled()},r.prototype.isAddButtonDisabled=function(){return!!(this.schema.hasOwnProperty("maxItems")&&Array.isArray(this.formProperty.properties)&&this.formProperty.properties.length>=this.schema.maxItems)},r.prototype.isRemoveButtonDisabled=function(){return!!(this.schema.hasOwnProperty("minItems")&&Array.isArray(this.formProperty.properties)&&this.formProperty.properties.length<=this.schema.minItems)},r=p([e.Component({selector:"sf-array-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n\t<span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n\t<div *ngFor="let itemProperty of formProperty.properties">\n\t\t<sf-form-element [formProperty]="itemProperty"></sf-form-element>\n\t\t<button (click)="removeItem(itemProperty)" class="btn btn-default array-remove-button"\n\t\t\t[disabled]="isRemoveButtonDisabled()" \n\t\t\t*ngIf="!(schema.hasOwnProperty(\'minItems\') && schema.hasOwnProperty(\'maxItems\') && schema.minItems === schema.maxItems)"\n\t\t\t>\n\t\t\t<span class="glyphicon glyphicon-minus" aria-hidden="true"></span> Remove\n\t\t</button>\n\t</div>\n\t<button (click)="addItem()" class="btn btn-default array-add-button"\n\t\t[disabled]="isAddButtonDisabled()"\n\t\t*ngIf="!(schema.hasOwnProperty(\'minItems\') && schema.hasOwnProperty(\'maxItems\') && schema.minItems === schema.maxItems)"\n\t>\n\t\t<span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add\n\t</button>\n</div>'})],r)}(Z),rt=function(){function t(){}return t=p([e.Component({selector:"sf-button-widget",template:'<button (click)="button.action($event)">{{button.label}}</button>'})],t)}(),nt=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return c(r,t),r=p([e.Component({selector:"sf-form-object",template:'<fieldset *ngFor="let fieldset of formProperty.schema.fieldsets">\n\t<legend *ngIf="fieldset.title">{{fieldset.title}}</legend>\n\t<div *ngIf="fieldset.description">{{fieldset.description}}</div>\n\t<div *ngFor="let fieldId of fieldset.fields">\n\t\t<sf-form-element [formProperty]="formProperty.getProperty(fieldId)"></sf-form-element>\n\t</div>\n</fieldset>'})],r)}(tt),it=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.checked={},e}return c(r,t),r.prototype.ngAfterViewInit=function(){var t=this,e=this.control;this.formProperty.valueChanges.subscribe((function(r){e.value!==r&&(e.setValue(r,{emitEvent:!1}),r&&Array.isArray(r)&&r.map((function(e){return t.checked[e]=!0})))})),this.formProperty.errorsChanges.subscribe((function(t){e.setErrors(t,{emitEvent:!0})})),e.valueChanges.subscribe((function(e){t.formProperty.setValue(e,!1)}))},r.prototype.onCheck=function(t){t.checked?this.checked[t.value]=!0:delete this.checked[t.value],this.formProperty.setValue(Object.keys(this.checked),!1)},r=p([e.Component({selector:"sf-checkbox-widget",template:'<div class="widget form-group">\n    <label [attr.for]="id" class="horizontal control-label">\n        {{ schema.title }}\n    </label>\n\t<div *ngIf="schema.type!=\'array\'" class="checkbox">\n\t\t<label class="horizontal control-label">\n\t\t\t<input [formControl]="control" [attr.name]="name" [attr.id]="id" [indeterminate]="control.value !== false && control.value !== true ? true :null" type="checkbox" [disabled]="schema.readOnly">\n\t\t\t<input *ngIf="schema.readOnly" [attr.name]="name" type="hidden" [formControl]="control">\n\t\t\t{{schema.description}}\n\t\t</label>\n\t</div>\n\t<ng-container *ngIf="schema.type===\'array\'">\n\t\t<div *ngFor="let option of schema.items.oneOf" class="checkbox">\n\t\t\t<label class="horizontal control-label">\n\t\t\t\t<input [attr.name]="name"\n\t\t\t\t\tvalue="{{option.enum[0]}}" type="checkbox" \n\t\t\t\t\t[attr.disabled]="schema.readOnly"\n\t\t\t\t\t(change)="onCheck($event.target)"\n\t\t\t\t\t[attr.checked]="checked[option.enum[0]] ? true : null"\n\t\t\t\t\t[attr.id]="id + \'.\' + option.enum[0]"\n\t\t\t\t\t>\n\t\t\t\t{{option.description}}\n\t\t\t</label>\n\t\t</div>\n\t</ng-container>\n</div>'})],r)}(Y),ot=function(t){function r(){var e=t.call(this)||this;return e.reader=new FileReader,e.filedata={},e}return c(r,t),r.prototype.ngAfterViewInit=function(){var t=this,e=this.control;this.formProperty.errorsChanges.subscribe((function(t){e.setErrors(t,{emitEvent:!0})})),this.reader.onloadend=function(){t.filedata.data=window.btoa(t.reader.result),t.formProperty.setValue(t.filedata,!1)}},r.prototype.onFileChange=function(t){var e=t.target.files[0];this.filedata.filename=e.name,this.filedata.size=e.size,this.filedata["content-type"]=e.type,this.filedata.encoding="base64",this.reader.readAsBinaryString(e)},r=p([e.Component({selector:"sf-file-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n    <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n  <input [name]="name" class="text-widget file-widget" [attr.id]="id"\n    [formControl]="control" type="file" [attr.disabled]="schema.readOnly?true:null"\n    (change)="onFileChange($event)">\n\t<input *ngIf="schema.readOnly" [attr.name]="name" type="hidden" [formControl]="control">\n</div>'}),u("design:paramtypes",[])],r)}(Y),st=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return c(r,t),r=p([e.Component({selector:"sf-integer-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n  <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n\t<input [attr.readonly]="schema.readOnly?true:null" [attr.name]="name"\n\t[attr.id]="id"\n\tclass="text-widget integer-widget form-control" [formControl]="control"\n\t[attr.type]="\'number\'" [attr.min]="schema.minimum" [attr.max]="schema.maximum"\n\t[attr.placeholder]="schema.placeholder"\n\t[attr.maxLength]="schema.maxLength || null"\n  [attr.minLength]="schema.minLength || null">\n</div>'})],r)}(Y),at=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return c(r,t),r=p([e.Component({selector:"sf-textarea-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n    <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n\t<textarea [readonly]="schema.readOnly" [name]="name"\n\t\t[attr.id]="id"\n\t\tclass="text-widget textarea-widget form-control"\n\t\t[attr.placeholder]="schema.placeholder"\n\t\t[attr.maxLength]="schema.maxLength || null"\n    [attr.minLength]="schema.minLength || null"\n\t\t[formControl]="control"></textarea>\n</div>'})],r)}(Y),lt=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return c(r,t),r=p([e.Component({selector:"sf-radio-widget",template:'<div class="widget form-group">\n\t<label>{{schema.title}}</label>\n    <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n\t<div *ngFor="let option of schema.oneOf" class="radio">\n\t\t<label class="horizontal control-label">\n\t\t\t<input [formControl]="control" [attr.name]="name" [attr.id]="id + \'.\' + option.enum[0]" value="{{option.enum[0]}}" type="radio"  [disabled]="schema.readOnly||option.readOnly">\n\t\t\t{{option.description}}\n\t\t</label>\n\t</div>\n\t<input *ngIf="schema.readOnly" [attr.name]="name" type="hidden" [formControl]="control">\n</div>'})],r)}(Y),ct=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return c(r,t),r=p([e.Component({selector:"sf-range-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n    <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\t\n\t<input [name]="name" class="text-widget range-widget" [attr.id]="id"\n\t[formControl]="control" [attr.type]="\'range\'" [attr.min]="schema.minimum" [attr.max]="schema.maximum" [disabled]="schema.readOnly?true:null" >\n\t<input *ngIf="schema.readOnly" [attr.name]="name" type="hidden">\n</div>'})],r)}(Y),pt=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return c(r,t),r=p([e.Component({selector:"sf-select-widget",template:'<div class="widget form-group">\n\t<label [attr.for]="id" class="horizontal control-label">\n\t\t{{ schema.title }}\n\t</label>\n\n\t<span *ngIf="schema.description" class="formHelp">\n\t\t{{schema.description}}\n\t</span>\n\n\t<select *ngIf="schema.type!=\'array\'" [formControl]="control" [attr.name]="name" [attr.id]="id" [disabled]="schema.readOnly" [disableControl]="schema.readOnly" class="form-control">\n\t\t<ng-container *ngIf="schema.oneOf; else use_enum">\n\t\t\t<option *ngFor="let option of schema.oneOf" [ngValue]="option.enum[0]" >{{option.description}}</option>\n\t\t</ng-container>\n\t\t<ng-template #use_enum>\n\t\t\t<option *ngFor="let option of schema.enum" [ngValue]="option" >{{option}}</option>\n\t\t</ng-template>\n\t</select>\n\n\t<select *ngIf="schema.type===\'array\'" multiple [formControl]="control" [attr.name]="name" [attr.id]="id" [disabled]="schema.readOnly" [disableControl]="schema.readOnly" class="form-control">\n    <option *ngFor="let option of schema.items.oneOf" [ngValue]="option.enum[0]" [disabled]="option.readOnly">{{option.description}}</option>\n\t</select>\n\n\t<input *ngIf="schema.readOnly" [attr.name]="name" type="hidden" [formControl]="control">\n</div>'})],r)}(Y),ut=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return c(r,t),r.prototype.getInputType=function(){return this.schema.widget.id&&"string"!==this.schema.widget.id?this.schema.widget.id:"text"},r=p([e.Component({selector:"sf-string-widget",template:'<input *ngIf="this.schema.widget.id ===\'hidden\'; else notHiddenFieldBlock"\n  [attr.name]="name" type="hidden" [formControl]="control">\n<ng-template #notHiddenFieldBlock>\n<div class="widget form-group">\n    <label [attr.for]="id" class="horizontal control-label">\n    \t{{ schema.title }}\n    </label>\n    <span *ngIf="schema.description" class="formHelp">{{schema.description}}</span>\n    <input [name]="name" [attr.readonly]="(schema.widget.id!==\'color\') && schema.readOnly?true:null"\n    class="text-widget.id textline-widget form-control"\n    [attr.type]="!this.schema.widget.id || this.schema.widget.id === \'string\' ? \'text\' : this.schema.widget.id"\n    [attr.id]="id"  [formControl]="control" [attr.placeholder]="schema.placeholder"\n    [attr.maxLength]="schema.maxLength || null"\n    [attr.minLength]="schema.minLength || null"\n    [attr.required]="schema.isRequired || null"\n    [attr.disabled]="(schema.widget.id==\'color\' && schema.readOnly)?true:null">\n    <input *ngIf="(schema.widget.id===\'color\' && schema.readOnly)" [attr.name]="name" type="hidden" [formControl]="control">\n</div>\n</ng-template>'})],r)}(Y),ht=function(t){function r(){var e=t.call(this)||this;return e.register("array",et),e.register("object",nt),e.register("string",ut),e.register("search",ut),e.register("tel",ut),e.register("url",ut),e.register("email",ut),e.register("password",ut),e.register("color",ut),e.register("date",ut),e.register("date-time",ut),e.register("time",ut),e.register("integer",st),e.register("number",st),e.register("range",ct),e.register("textarea",at),e.register("file",ot),e.register("select",pt),e.register("radio",lt),e.register("boolean",it),e.register("checkbox",it),e.register("button",rt),e.setDefaultWidget(ut),e}return c(r,t),r=p([e.Injectable(),u("design:paramtypes",[])],r)}(j),dt=function(){function t(t){this.ngControl=t}return Object.defineProperty(t.prototype,"disableControl",{set:function(t){var e=t?"disable":"enable";this.ngControl.control[e]()},enumerable:!0,configurable:!0}),t.ctorParameters=function(){return[{type:r.NgControl}]},p([e.Input(),u("design:type",Boolean),u("design:paramtypes",[Boolean])],t.prototype,"disableControl",null),t=p([e.Directive({selector:"[disableControl]"}),u("design:paramtypes",[r.NgControl])],t)}(),ft=function(){function t(){}return t=p([e.Component({selector:"sf-default-field",template:"<p>Unknow type</p>"})],t)}(),yt=[{provide:j,useClass:ht},{provide:V,useClass:R},{provide:B,useClass:D}],mt=function(){function t(){}var n;return n=t,t.forRoot=function(){return{ngModule:n,providers:f(yt)}},t=n=p([e.NgModule({imports:[a.CommonModule,r.FormsModule,r.ReactiveFormsModule],declarations:[q,M,L,T,ft,et,rt,nt,it,ot,st,at,lt,ct,pt,ut,dt],entryComponents:[q,M,L,T,et,rt,nt,it,ot,st,at,lt,ct,pt,ut],exports:[L,q,M,T,et,rt,nt,it,ot,st,at,lt,ct,pt,ut,dt]})],t)}(),gt=function(){function t(){this.changes=new e.EventEmitter}return t.prototype.changed=function(){this.changes.emit()},t=p([e.Injectable(),u("design:paramtypes",[])],t)}(),vt=function(){function t(){}return t.prototype.getTextContent=function(t){var e=Array.from(t.nativeElement.childNodes).filter((function(t){return t.nodeType===t.TEXT_NODE})).pop();return e&&e.nodeValue?e.nodeValue.trim():""},t}(),bt=function(t){function r(r){var n=t.call(this)||this;return n.elementRef=r,n.label="",n.click=new e.EventEmitter,n}var n;return c(r,t),n=r,r.prototype.setLabelFromContent=function(){var t=this.getTextContent(this.elementRef);t&&!this.label&&(this.label=t)},r.prototype.ngAfterContentInit=function(){this.setLabelFromContent()},r.ctorParameters=function(){return[{type:e.ElementRef}]},p([e.Input(),u("design:type",String)],r.prototype,"id",void 0),p([e.Input(),u("design:type",Object)],r.prototype,"label",void 0),p([e.Input(),u("design:type",Object)],r.prototype,"widget",void 0),p([e.Output(),u("design:type",Object)],r.prototype,"click",void 0),r=n=p([e.Component({selector:"sf-button",template:"<ng-content></ng-content>\n",providers:[{provide:vt,useExisting:e.forwardRef((function(){return n}))}]}),u("design:paramtypes",[e.ElementRef])],r)}(vt);!function(t){t.String="string",t.Object="object",t.Array="array",t.Boolean="boolean",t.Integer="integer",t.Number="number"}(X||(X={}));var Pt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="",e}return c(e,t),Object.defineProperty(e.prototype,"path",{get:function(){return this.name?"/"+this.name:""},enumerable:!0,configurable:!0}),e.prototype.getButtons=function(){var t=this;return this.childButtons.map((function(e,r){if(!e.id){var n=Math.random().toString(16).substr(2,8);e.id=t.name+n+"_"+(r+1)}t.actionRegistry.register(e.id,e.click.emit.bind(e.click));var i={id:e.id,label:e.label};return e.widget&&(i.widget=e.widget),i}))},e.prototype.getFieldsValidators=function(t){return t.reduce((function(t,e){return t.concat(e.getValidators())}),[])},e.prototype.getFieldsSchema=function(t){var e=this;return t.reduce((function(t,r){switch(e.type){case X.Array:t.items=r.getSchema();break;default:t.properties||(t.properties={}),t.properties[r.name]=r.getSchema()}var n=r.getButtons();return n.length>0&&(t.buttons=n),r.required?(t.required||(t.required=[]),t.required.push(r.name),t):t}),{})},e}(vt),wt=function(t){function r(e){var r=t.call(this)||this;return r.elementRef=e,r}return c(r,t),r.prototype.ngOnInit=function(){this.description=this.getTextContent(this.elementRef)},r.ctorParameters=function(){return[{type:e.ElementRef}]},p([e.Input(),u("design:type",Object)],r.prototype,"value",void 0),r=p([e.Component({selector:"sf-item",template:"<ng-content></ng-content>\n"}),u("design:paramtypes",[e.ElementRef])],r)}(vt),Ct=function(t){function r(e,r,n){var i=t.call(this)||this;return i.elementRef=e,i.templateSchemaService=r,i.actionRegistry=n,i.type=X.String,i.schema={},i}var i;return c(r,t),i=r,r.prototype.getSchema=function(){var t=this,e=this.getFieldsSchema(this.childFields.filter((function(e){return e!==t}))),r=e.properties,n=e.items,i=e.required,o=this.getOneOf(),s={type:this.type};void 0!==this.title&&(s.title=this.title),void 0!==r&&(s.properties=r),void 0!==n&&(s.items=n),void 0!==i&&(s.required=i),void 0!==o&&(s.oneOf=o),void 0!==this.description&&(s.description=this.description),void 0!==this.placeholder&&(s.placeholder=this.placeholder),void 0!==this.format&&(s.format=this.format),void 0!==this.widget&&(s.widget=this.widget),void 0!==this.readOnly&&(s.readOnly=this.readOnly);var a=this.getButtons();return a.length>0&&(s.buttons=a),Object.assign(s,this.schema)},r.prototype.getValidators=function(){var t=this,e=this.getFieldsValidators(this.childFields.filter((function(e){return e!==t}))).map((function(e){var r=e.path,n=e.validator;return{path:t.path+r,validator:n}}));return this.validator?(e.push({path:this.path,validator:this.validator}),e):e},r.prototype.ngOnChanges=function(t){var e,r,n=Object.keys(t);if(n.length>0)try{for(var i=h(n),o=i.next();!o.done;o=i.next()){if(!t[o.value].isFirstChange()){this.templateSchemaService.changed();break}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},r.prototype.getOneOf=function(){if(0!==this.childItems.length){var t=this.childItems.map((function(t){var e=t.value,r=t.description;return Array.isArray(e)?{enum:e,description:r}:{enum:[e],description:r}}));if(0!==t.length)return t}},r.prototype.setTitleFromContent=function(){var t=this.getTextContent(this.elementRef);t&&!this.title&&(this.title=t)},r.prototype.ngAfterContentInit=function(){var t=this;this.setTitleFromContent(),n.merge(this.childFields.changes,this.childItems.changes,this.childButtons.changes).subscribe((function(){return t.templateSchemaService.changed()}))},r.ctorParameters=function(){return[{type:e.ElementRef},{type:gt},{type:y}]},p([e.ContentChildren(i),u("design:type",e.QueryList)],r.prototype,"childFields",void 0),p([e.ContentChildren(wt),u("design:type",e.QueryList)],r.prototype,"childItems",void 0),p([e.ContentChildren(bt),u("design:type",e.QueryList)],r.prototype,"childButtons",void 0),p([e.Input(),u("design:type",String)],r.prototype,"name",void 0),p([e.Input(),u("design:type",Object)],r.prototype,"type",void 0),p([e.Input(),u("design:type",String)],r.prototype,"format",void 0),p([e.Input(),u("design:type",Boolean)],r.prototype,"required",void 0),p([e.Input(),u("design:type",Boolean)],r.prototype,"readOnly",void 0),p([e.Input(),u("design:type",String)],r.prototype,"title",void 0),p([e.Input(),u("design:type",String)],r.prototype,"description",void 0),p([e.Input(),u("design:type",String)],r.prototype,"placeholder",void 0),p([e.Input(),u("design:type",Object)],r.prototype,"widget",void 0),p([e.Input(),u("design:type",Function)],r.prototype,"validator",void 0),p([e.Input(),u("design:type",Object)],r.prototype,"schema",void 0),r=i=p([e.Component({selector:"sf-field",template:"<ng-content ></ng-content>\n"}),u("design:paramtypes",[e.ElementRef,gt,y])],r)}(Pt),Ot=function(t){function r(e,r,n,i,o){var s=t.call(this)||this;return s.actionRegistry=e,s.validatorRegistry=r,s.formComponent=n,s.terminatorService=i,s.templateSchemaService=o,s}return c(r,t),r.prototype.setFormDocumentSchema=function(t){var r=this;this.actionRegistry.clear(),this.validatorRegistry.clear();var n=this.getFieldsSchema(t);this.getFieldsValidators(t).forEach((function(t){var e=t.path,n=t.validator;r.validatorRegistry.register(e,n)}));var i=this.formComponent.schema;this.formComponent.schema={type:X.Object,properties:n.properties},n.required&&n.required.length>0&&(this.formComponent.schema.requred=n.required);var o=this.getButtons();o.length>0&&(this.formComponent.schema.buttons=o),this.formComponent.ngOnChanges({schema:new e.SimpleChange(i,this.formComponent.schema,Boolean(i))})},r.prototype.ngAfterContentInit=function(){var t=this;this.childFields.length>0&&this.setFormDocumentSchema(this.childFields.toArray()),n.merge(this.childFields.changes,this.templateSchemaService.changes).subscribe((function(){t.terminatorService.destroy(),t.setFormDocumentSchema(t.childFields.toArray())}))},r.ctorParameters=function(){return[{type:y},{type:I},{type:L},{type:F},{type:gt}]},p([e.ContentChildren(Ct),u("design:type",e.QueryList)],r.prototype,"childFields",void 0),p([e.ContentChildren(bt),u("design:type",e.QueryList)],r.prototype,"childButtons",void 0),r=p([e.Directive({selector:"sf-form[templateSchema]",providers:[gt]}),u("design:paramtypes",[y,I,L,F,gt])],r)}(Pt),xt=function(){function t(){}return t=p([e.NgModule({imports:[a.CommonModule],declarations:[Ot,Ct,bt,wt],exports:[Ot,Ct,bt,wt]})],t)}();t.ActionRegistry=y,t.ArrayLayoutWidget=Z,t.ArrayProperty=U,t.ArrayWidget=et,t.AtomicProperty=$,t.BindingRegistry=_,t.BooleanProperty=Q,t.ButtonWidget=rt,t.CheckboxWidget=it,t.ControlWidget=Y,t.DefaultWidgetRegistry=ht,t.DisableControlDirective=dt,t.FileWidget=ot,t.FormComponent=L,t.FormElementComponent=q,t.FormElementComponentAction=M,t.FormProperty=m,t.FormPropertyFactory=b,t.IntegerWidget=st,t.NumberProperty=J,t.ObjectLayoutWidget=tt,t.ObjectProperty=H,t.ObjectWidget=nt,t.RadioWidget=lt,t.RangeWidget=ct,t.SchemaFormModule=mt,t.SchemaPreprocessor=x,t.SchemaValidatorFactory=V,t.SelectWidget=pt,t.StringProperty=K,t.StringWidget=ut,t.TemplateSchemaModule=xt,t.TerminatorService=F,t.TextAreaWidget=at,t.ValidatorRegistry=I,t.Widget=G,t.WidgetChooserComponent=T,t.WidgetFactory=E,t.WidgetRegistry=j,t.ZSchemaValidatorFactory=R,t.ɵa=z,t.ɵb=y,t.ɵc=I,t.ɵd=k,t.ɵe=_,t.ɵf=x,t.ɵg=b,t.ɵh=B,t.ɵi=D,t.ɵj=ft,t.ɵk=Ot,t.ɵl=Pt,t.ɵm=vt,t.ɵn=gt,t.ɵo=Ct,t.ɵp=wt,t.ɵq=bt,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-schema-form.umd.min.js.map